{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{\"e/Ek\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"CartModule\",(function(){return cart_module_CartModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),core=__webpack_require__(\"fXoL\"),ngx_toastr=__webpack_require__(\"5eHb\"),fesm2015_router=__webpack_require__(\"tyNb\");let route_guard_guard_RouteGuard=(()=>{class RouteGuard{constructor(toaster,router){this.toaster=toaster,this.router=router}canActivate(route,state){if(sessionStorage.getItem(\"id\"))return!0;this.toaster.success(\"Please sign-in to continue\"),this.router.navigate([\"/sign-in\"])}}return RouteGuard.ɵfac=function(t){return new(t||RouteGuard)(core[\"ɵɵinject\"](ngx_toastr.b),core[\"ɵɵinject\"](fesm2015_router.c))},RouteGuard.ɵprov=core[\"ɵɵdefineInjectable\"]({token:RouteGuard,factory:RouteGuard.ɵfac}),RouteGuard})();var cart_details=__webpack_require__(\"1UKJ\"),api_service=__webpack_require__(\"H+bZ\"),numonly_directive=__webpack_require__(\"3iOn\");const _c0=[\"input\"];function CartDetailsComponent_ng_container_9_div_25_p_8_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\"),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r8=core[\"ɵɵnextContext\"]().$implicit;core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\" \",null==eachProduct_r8?null:eachProduct_r8.description,\"\")}}function CartDetailsComponent_ng_container_9_div_25_p_9_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\"),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r8=core[\"ɵɵnextContext\"]().$implicit;core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate\"](null==eachProduct_r8?null:eachProduct_r8.driveType)}}function CartDetailsComponent_ng_container_9_div_25_Template(rf,ctx){if(1&rf){const _r15=core[\"ɵɵgetCurrentView\"]();core[\"ɵɵelementStart\"](0,\"div\",29),core[\"ɵɵelementStart\"](1,\"div\",30),core[\"ɵɵelementStart\"](2,\"div\",31),core[\"ɵɵelement\"](3,\"img\",32),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](4,\"div\",33),core[\"ɵɵelementStart\"](5,\"span\"),core[\"ɵɵelementStart\"](6,\"strong\"),core[\"ɵɵtext\"](7),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](8,CartDetailsComponent_ng_container_9_div_25_p_8_Template,2,1,\"p\",4),core[\"ɵɵtemplate\"](9,CartDetailsComponent_ng_container_9_div_25_p_9_Template,2,1,\"p\",4),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](10,\"div\",34),core[\"ɵɵelementStart\"](11,\"div\",35),core[\"ɵɵelementStart\"](12,\"span\",36),core[\"ɵɵlistener\"](\"click\",(function(){core[\"ɵɵrestoreView\"](_r15);const productCount_r9=ctx.index;return core[\"ɵɵnextContext\"](2).decrementProductQuantity(productCount_r9)})),core[\"ɵɵtext\"](13,\"-\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](14,\"input\",37),core[\"ɵɵelementStart\"](15,\"span\",38),core[\"ɵɵlistener\"](\"click\",(function(){core[\"ɵɵrestoreView\"](_r15);const productCount_r9=ctx.index;return core[\"ɵɵnextContext\"](2).incrementProductQuantity(productCount_r9)})),core[\"ɵɵtext\"](16,\"+\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](17,\"h3\"),core[\"ɵɵtext\"](18),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()}if(2&rf){const eachProduct_r8=ctx.$implicit;core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"src\",eachProduct_r8.img,core[\"ɵɵsanitizeUrl\"]),core[\"ɵɵadvance\"](4),core[\"ɵɵtextInterpolate\"](null==eachProduct_r8?null:eachProduct_r8.code),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"\"!==(null==eachProduct_r8?null:eachProduct_r8.description)),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"\"!==(null==eachProduct_r8?null:eachProduct_r8.driveType)),core[\"ɵɵadvance\"](5),core[\"ɵɵproperty\"](\"value\",null==eachProduct_r8?null:eachProduct_r8.productQuantity),core[\"ɵɵadvance\"](4),core[\"ɵɵtextInterpolate1\"](\"$ \",(null==eachProduct_r8?null:eachProduct_r8.discountPrice)>0?null==eachProduct_r8?null:eachProduct_r8.discountPrice:null==eachProduct_r8?null:eachProduct_r8.price,\"\")}}function CartDetailsComponent_ng_container_9_div_29_div_1_p_3_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\"),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r17=core[\"ɵɵnextContext\"](2).$implicit;core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\"(\",null==eachProduct_r17?null:eachProduct_r17.driveType,\")\")}}function CartDetailsComponent_ng_container_9_div_29_div_1_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",43),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](3,CartDetailsComponent_ng_container_9_div_29_div_1_p_3_Template,2,1,\"p\",4),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r17=core[\"ɵɵnextContext\"]().$implicit;core[\"ɵɵadvance\"](2),core[\"ɵɵtextInterpolate\"](null==eachProduct_r17?null:eachProduct_r17.description),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"\"!==(null==eachProduct_r17?null:eachProduct_r17.driveType))}}function CartDetailsComponent_ng_container_9_div_29_ng_template_2_p_3_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\"),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r17=core[\"ɵɵnextContext\"](2).$implicit;core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\"(\",null==eachProduct_r17?null:eachProduct_r17.description,\")\")}}function CartDetailsComponent_ng_container_9_div_29_ng_template_2_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",43),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](3,CartDetailsComponent_ng_container_9_div_29_ng_template_2_p_3_Template,2,1,\"p\",4),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r17=core[\"ɵɵnextContext\"]().$implicit;core[\"ɵɵadvance\"](2),core[\"ɵɵtextInterpolate\"](null==eachProduct_r17?null:eachProduct_r17.code),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"\"!==(null==eachProduct_r17?null:eachProduct_r17.description))}}function CartDetailsComponent_ng_container_9_div_29_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",39),core[\"ɵɵtemplate\"](1,CartDetailsComponent_ng_container_9_div_29_div_1_Template,4,2,\"div\",40),core[\"ɵɵtemplate\"](2,CartDetailsComponent_ng_container_9_div_29_ng_template_2_Template,4,2,\"ng-template\",null,41,core[\"ɵɵtemplateRefExtractor\"]),core[\"ɵɵelementStart\"](4,\"div\",42),core[\"ɵɵelementStart\"](5,\"h3\"),core[\"ɵɵtext\"](6),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r17=ctx.$implicit,_r19=core[\"ɵɵreference\"](3);core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"spare\"!==(null==eachProduct_r17?null:eachProduct_r17.type))(\"ngIfElse\",_r19),core[\"ɵɵadvance\"](5),core[\"ɵɵtextInterpolate1\"](\"$ \",(null==eachProduct_r17?null:eachProduct_r17.productQuantity)*((null==eachProduct_r17?null:eachProduct_r17.discountPrice)>0?null==eachProduct_r17?null:eachProduct_r17.discountPrice:null==eachProduct_r17?null:eachProduct_r17.price),\"\")}}function CartDetailsComponent_ng_container_9_div_49_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",26),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2,\"Dealer Discount (10%) \"),core[\"ɵɵelement\"](3,\"br\"),core[\"ɵɵtext\"](4,\" (In AUD)\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](5,\"h3\"),core[\"ɵɵtext\"](6),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r5=core[\"ɵɵnextContext\"](2);core[\"ɵɵadvance\"](6),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r5.finalPrice+ctx_r5.gstPrice-ctx_r5.dealerDiscountAmount,\"\")}}function CartDetailsComponent_ng_container_9_div_50_Template(rf,ctx){if(1&rf){const _r28=core[\"ɵɵgetCurrentView\"]();core[\"ɵɵelementStart\"](0,\"div\",44),core[\"ɵɵelementStart\"](1,\"button\"),core[\"ɵɵelementStart\"](2,\"a\",45),core[\"ɵɵlistener\"](\"click\",(function(){return core[\"ɵɵrestoreView\"](_r28),core[\"ɵɵnextContext\"](2).onContinue(\"sign-in\")})),core[\"ɵɵtext\"](3,\"Continue \"),core[\"ɵɵelementStart\"](4,\"span\",46),core[\"ɵɵtext\"](5,\"Click here to sign-in\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()}}function CartDetailsComponent_ng_container_9_ng_container_51_Template(rf,ctx){if(1&rf){const _r30=core[\"ɵɵgetCurrentView\"]();core[\"ɵɵelementContainerStart\"](0),core[\"ɵɵelementStart\"](1,\"button\"),core[\"ɵɵelementStart\"](2,\"a\",47),core[\"ɵɵlistener\"](\"click\",(function(){return core[\"ɵɵrestoreView\"](_r30),core[\"ɵɵnextContext\"](2).onContinue(\"continue\")})),core[\"ɵɵtext\"](3,\"Continue\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementContainerEnd\"]()}}function CartDetailsComponent_ng_container_9_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementContainerStart\"](0),core[\"ɵɵelementStart\"](1,\"div\",13),core[\"ɵɵelementStart\"](2,\"div\",2),core[\"ɵɵelementStart\"](3,\"div\",14),core[\"ɵɵelementStart\"](4,\"div\",15),core[\"ɵɵelementStart\"](5,\"a\",16),core[\"ɵɵtext\"](6,\"1\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](7,\"small\"),core[\"ɵɵtext\"](8,\"Cart\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](9,\"div\",17),core[\"ɵɵelementStart\"](10,\"a\",16),core[\"ɵɵtext\"](11,\"2\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](12,\"small\"),core[\"ɵɵtext\"](13,\"Address\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](14,\"div\",17),core[\"ɵɵelementStart\"](15,\"a\",16),core[\"ɵɵtext\"](16,\"3\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](17,\"small\"),core[\"ɵɵtext\"](18,\"Payment\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](19,\"div\",18),core[\"ɵɵelementStart\"](20,\"div\",2),core[\"ɵɵelementStart\"](21,\"div\",19),core[\"ɵɵelementStart\"](22,\"div\",20),core[\"ɵɵelementStart\"](23,\"h3\",21),core[\"ɵɵtext\"](24,\"Cart\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](25,CartDetailsComponent_ng_container_9_div_25_Template,19,6,\"div\",22),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](26,\"div\",23),core[\"ɵɵelementStart\"](27,\"h3\",21),core[\"ɵɵtext\"](28,\"Price Detail\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](29,CartDetailsComponent_ng_container_9_div_29_Template,7,3,\"div\",24),core[\"ɵɵelementStart\"](30,\"div\"),core[\"ɵɵelementStart\"](31,\"div\",25),core[\"ɵɵelementStart\"](32,\"div\",26),core[\"ɵɵelementStart\"](33,\"h3\"),core[\"ɵɵtext\"](34,\"Sub Total\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](35,\"h3\"),core[\"ɵɵtext\"](36),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](37,\"div\",26),core[\"ɵɵelementStart\"](38,\"h3\"),core[\"ɵɵtext\"](39,\"Shipping & Handling\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](40,\"h3\"),core[\"ɵɵtext\"](41),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](42,\"div\",26),core[\"ɵɵelementStart\"](43,\"h3\"),core[\"ɵɵtext\"](44,\"Total (including GST@10%) \"),core[\"ɵɵelement\"](45,\"br\"),core[\"ɵɵtext\"](46,\" (In AUD)\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](47,\"h3\"),core[\"ɵɵtext\"](48),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](49,CartDetailsComponent_ng_container_9_div_49_Template,7,1,\"div\",27),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](50,CartDetailsComponent_ng_container_9_div_50_Template,6,0,\"div\",28),core[\"ɵɵtemplate\"](51,CartDetailsComponent_ng_container_9_ng_container_51_Template,4,0,\"ng-container\",4),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementContainerEnd\"]()),2&rf){const ctx_r0=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](25),core[\"ɵɵproperty\"](\"ngForOf\",ctx_r0.products),core[\"ɵɵadvance\"](4),core[\"ɵɵproperty\"](\"ngForOf\",ctx_r0.products),core[\"ɵɵadvance\"](7),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r0.grandTotal,\"\"),core[\"ɵɵadvance\"](5),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r0.shippingCharges,\"\"),core[\"ɵɵadvance\"](7),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r0.finalPrice+ctx_r0.gstPrice,\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx_r0.applyDealerDiscount),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",!ctx_r0.toggleBtn),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx_r0.toggleBtn)}}function CartDetailsComponent_ng_container_10_p_3_Template(rf,ctx){if(1&rf){const _r34=core[\"ɵɵgetCurrentView\"]();core[\"ɵɵelementStart\"](0,\"p\",51),core[\"ɵɵtext\"](1,\"Your cart is currently empty. Please \"),core[\"ɵɵelementStart\"](2,\"a\",52),core[\"ɵɵlistener\"](\"click\",(function(){return core[\"ɵɵrestoreView\"](_r34),core[\"ɵɵnextContext\"](2).redirect(\"sign-in\")})),core[\"ɵɵtext\"](3,\"Sign-in\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtext\"](4,\" or \"),core[\"ɵɵelementStart\"](5,\"a\",52),core[\"ɵɵlistener\"](\"click\",(function(){return core[\"ɵɵrestoreView\"](_r34),core[\"ɵɵnextContext\"](2).redirect(\"sign-up\")})),core[\"ɵɵtext\"](6,\"Sign-up\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtext\"](7,\" here.\"),core[\"ɵɵelementEnd\"]()}}function CartDetailsComponent_ng_container_10_p_4_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",51),core[\"ɵɵtext\"](1,\"Your cart is currently empty. Please select a pump or spare part to purchase.\"),core[\"ɵɵelementEnd\"]())}function CartDetailsComponent_ng_container_10_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementContainerStart\"](0),core[\"ɵɵelementStart\"](1,\"div\",48),core[\"ɵɵelement\"](2,\"img\",49),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](3,CartDetailsComponent_ng_container_10_p_3_Template,8,0,\"p\",50),core[\"ɵɵtemplate\"](4,CartDetailsComponent_ng_container_10_p_4_Template,2,0,\"p\",50),core[\"ɵɵelementContainerEnd\"]()),2&rf){const ctx_r1=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"ngIf\",!ctx_r1.toggleBtn),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx_r1.toggleBtn)}}function CartDetailsComponent_p_18_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",53),core[\"ɵɵtext\"](1,\"If you remove this, then accessories related to this will be removed and spares will be charged as per original price.\"),core[\"ɵɵelementEnd\"]())}const _c1=function(){return[\"/home\"]};let cart_details_component_CartDetailsComponent=(()=>{class CartDetailsComponent{constructor(apiService,router,activatedRoute){this.apiService=apiService,this.router=router,this.activatedRoute=activatedRoute,this.subscribe=[],this.grandTotal=0,this.shippingCharges=0,this.finalPrice=0,this.productQuantity=0,this.products=[],this.toggleBtn=!1,this.showDeleteMsg=!1,this.applyDealerDiscount=!1,this.dealerDiscountAmount=0}ngOnInit(){if(sessionStorage.getItem(\"id\")){if(this.toggleBtn=!0,sessionStorage.getItem(\"cartId\")){if(\"Dealer\"===window.atob(sessionStorage.getItem(\"userType\"))&&\"D\"===window.atob(sessionStorage.getItem(\"userStatus\")))if(this.applyDealerDiscount=!0,null===window.atob(sessionStorage.getItem(\"userDiscount\")))this.apiService.dealerDiscount().subscribe(res=>{!0===res.return&&(this.dealerDiscountPercentage=res.dealer_discount,this.dealerDiscountPercentage=.01*this.dealerDiscountPercentage)});else{let userDiscount=window.atob(sessionStorage.getItem(\"userDiscount\"));this.dealerDiscountPercentage=.01*+userDiscount}sessionStorage.getItem(\"cart\")?this.updateCartDetails(window.atob(sessionStorage.getItem(\"cart\")),\"session\"):this.subscribe.push(this.activatedRoute.data.subscribe(res=>{this.products=res.cartData,this.insertImages(this.products),console.log(\"products\",this.products),this.getProductQuantity(),this.findGrandTotal()}))}else if(this.getCartItems(),this.products.length>0){const cartData={user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(this.products)};this.subscribe.push(this.apiService.addToCart(cartData).subscribe(res=>{200===res.code&&(sessionStorage.removeItem(\"cart\"),sessionStorage.setItem(\"cartId\",window.btoa(res.cart_details.id)),this.products=JSON.parse(res.cart_details.cart),this.getProductQuantity(),this.findGrandTotal(),this.apiService.totalItemsInCart())}))}}else null===sessionStorage.getItem(\"cardId\")&&(this.getCartItems(),this.getProductQuantity(),this.toggleBtn=!1)}insertImages(products){let pumpModel;products.forEach(element=>{if(pumpModel=\"product\"===element.type?element.description.split(\" \"):\"\",\"Surface\"!==pumpModel[0]||\"Close\"!==pumpModel[2]&&\"Bare\"!==pumpModel[2])if(\"Multipurpose\"!==pumpModel[0]||\"Close\"!==pumpModel[1]&&\"Bare\"!==pumpModel[1]){if(\"accessory\"===element.type||\"spare\"===element.type)switch(element.code){case\"Baseplate\":element.img=\"assets/images/SparesImg/Baseplate_pic.png\";break;case\"DRP\":element.img=\"assets/images/SparesImg/DRP_pic.png\";break;case\"Rotor\":element.img=\"assets/images/SparesImg/rotor.jpg\";break;case\"Stator\":element.img=\"assets/images/icons/stator.png\";break;case\"Mech Seal\":element.img=\"assets/images/SparesImg/Mech_seal.jpeg\";break;case\"UJ M Kit\":element.img=\"assets/images/SparesImg/UJ_KIT.jpg\";break;case\"Pump Lantern\":element.img=\"assets/images/SparesImg/PUMPLANTERN.BMP\";break;case\"Foot\":element.img=\"assets/images/SparesImg/FOOT.BMP\";break;case\"Tie Rod\":element.img=\"assets/images/SparesImg/TIEROD.BMP\";break;case\"Pump Housing\":element.img=\"assets/images/SparesImg/PUMPHOUSING.BMP\";break;case\"End Cover\":element.img=\"assets/images/SparesImg/END_COVER.BMP\";break;case\"Seal Plate\":element.img=\"assets/images/SparesImg/SEAL_PLATE.BMP\";break;case\"Mech Seal Housing\":element.img=\"assets/images/SparesImg/MECHSEALHOUSING.BMP\";break;case\"Shaft Stub Price\":element.img=\"assets/images/SparesImg/SHAFT.BMP\";break;case\"Coupling Rod\":element.img=\"assets/images/SparesImg/COUPLINGROD.BMP\";break;case\"B.S.R. Retaining Ring\":case\"Boot Seal Reatainer\":element.img=\"assets/images/SparesImg/BOOTSEALRETAINER.BMP\";break;case\"Boot Seal Support Ring\":element.img=\"assets/images/SparesImg/Boot_Seal_Support_Ring.bmp\";break;case\"Boot Seal\":element.img=\"assets/images/SparesImg/BOOT_SEAL.BMP\";break;case\"Foot And Face Mounted Motor 240v 4Pole\":case\"Foot And Face Mounted Motor 240v 6Pole\":element.img=\"assets/images/SparesImg/Foot_face_mounted_motor.jpg\";break;case\"Bearing Cover\":element.img=\"assets/images/SparesImg/BEARINGCOVER.BMP\";break;case\"Bearing Spacer External\":element.img=\"assets/images/SparesImg/BEARINGSPACER.BMP\";break;case\"Mechanical Seal\":element.img=\"assets/images/SparesImg/Mechanical-Seal_image.jpg\";break;case\"Ball_Bearing\":element.img=\"assets/images/SparesImg/BALLBEARING.BMP\";break;case\"Foot Support For Stator Housing\":element.img=\"assets/images/SparesImg/FOOT_FOR_STATOR_HOUSING.BMP\";break;case\"Foot Support For Bearing Housing\":element.img=\"assets/images/SparesImg/FOOTFORBEARINGHOUSING.BMP\";break;case\"Stator Housing\":element.img=\"assets/images/SparesImg/STATORHOUSING.BMP\";break;case\"Bonded Bush\":element.img=\"assets/images/SparesImg/BONDEDBUSH.BMP\";break;case\"Bearning Housing\":element.img=\"assets/images/SparesImg/BEARINGHOUSING.BMP\";break;case\"Ball Bearing Small\":case\"Ball Bearing Large\":element.img=\"assets/images/SparesImg/BALLBEARING.BMP\";break;case\"Mech Seal Retainer\":element.img=\"assets/images/SparesImg/MECHANICHALSEALRETAINER.BMP\";break;case\"Stator Support Ring\":element.img=\"assets/images/SparesImg/STATOR_SUPPORT_RING.jpg\";break;case\"Drive Shaft\":element.img=\"assets/images/SparesImg/SHAFT.BMP.BMP\";break;case\"Abutment Ring\":element.img=\"assets/images/SparesImg/ABUTMENT_RING.jpg\";break;case\"Bearing\":element.img=\"assets/images/SparesImg/BALLBEARING.BMP\";break;default:element.img=\"assets/images/icons/accessories2.png\"}}else element.img=\"assets/images/banner/DC.png\";else element.img=\"assets/images/AGCACC/AGCApumpcopy.png\"})}getProductQuantity(){this.productQuantity=0,this.products.forEach(product=>{this.productQuantity=product.productQuantity+this.productQuantity})}updateCartDetails(cartArray,type){if(\"session\"===type){const cartLocalData=JSON.parse(cartArray);let cart=[];const accessoriesToAdd=[],sparesToAdd=[];null!==cartLocalData&&(cartLocalData.forEach(cartData=>{\"product\"===cartData.type?cart.push(new cart_details.a(cartData.productId,cartData.code,cartData.description,cartData.price,cartData.discountPrice,cartData.type,cartData.pole,cartData.flow,cartData.head,cartData.speed,cartData.power,cartData.engineSpeed,cartData.enginekW,cartData.driveType,cartData.productQuantity)):\"accessory\"===cartData.type?accessoriesToAdd.push(cartData):\"spare\"===cartData.type&&sparesToAdd.push(cartData)}),this.subscribe.push(this.activatedRoute.data.subscribe(res=>{let cartDetails=[];if(cartDetails=res.cartData,cartDetails.length<=0){cart.length&&cartDetails.push(...cart),accessoriesToAdd.length&&cartDetails.push(...accessoriesToAdd),sparesToAdd.length&&cartDetails.push(...sparesToAdd);const updateCartData={id:window.atob(sessionStorage.getItem(\"cartId\")),user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(cartDetails)};this.apiService.updateCart(updateCartData).subscribe(response=>{200===response.code&&(sessionStorage.removeItem(\"cart\"),this.apiService.getCartById(updateCartData.id).subscribe(response=>{200===response.code&&(this.products=JSON.parse(response.details.cart),this.insertImages(this.products),this.getProductQuantity(),this.findGrandTotal(),this.apiService.totalItemsInCart())}))})}else{const cartAccessoryDataSet=new Array,cartSpareDataSet=new Array;let cartProductDataSet,spareNotExist=!0,accessoryNotExist=!0,cartNotExist=!0;for(let i=0;i<cartDetails.length;i++)if(\"product\"===cartDetails[i].type){cartNotExist=!1;for(let j=0;j<cart.length;j++)(\"\"===cartDetails[i].driveType||cartDetails[i].driveType)===(\"\"===cart[j].driveType||cart[j].driveType)&&cartDetails[i].code===cart[j].code&&cartDetails[i].pole===cart[j].pole?cartDetails[i].productQuantity++:cartProductDataSet=cart}else if(\"accessory\"===cartDetails[i].type){accessoryNotExist=!1;for(let j=0;j<accessoriesToAdd.length;j++)accessoriesToAdd[j].description===cartDetails[i].description&&accessoriesToAdd[j].driveType===cartDetails[i].driveType&&accessoriesToAdd[j].pole===cartDetails[i].pole?cartDetails[i].productQuantity++:cartDetails.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.push(accessoriesToAdd[j])}else if(\"spare\"===cartDetails[i].type){spareNotExist=!1;for(let j=0;j<sparesToAdd.length;j++)sparesToAdd[j].description===cartDetails[i].description&&sparesToAdd[j].pole===cartDetails[i].pole&&sparesToAdd[j].driveType===cartDetails[i].driveType?cartDetails[i].productQuantity++:cartDetails.some(res=>{var _a;return res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===(null===(_a=sparesToAdd[j])||void 0===_a?void 0:_a.driveType)})||cartSpareDataSet.some(res=>{var _a;return res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===(null===(_a=sparesToAdd[j])||void 0===_a?void 0:_a.driveType)})||cartSpareDataSet.push(sparesToAdd[j])}cartAccessoryDataSet.length>0&&cartDetails.push(...cartAccessoryDataSet),cartSpareDataSet.length>0&&cartDetails.push(...cartSpareDataSet),(void 0!==cartProductDataSet||(null==cartProductDataSet?void 0:cartProductDataSet.length))&&cartDetails.push(...cartProductDataSet),accessoryNotExist&&cartDetails.push(...accessoriesToAdd),spareNotExist&&cartDetails.push(...sparesToAdd),cartNotExist&&cartDetails.push(...cart);const updateCartData={id:window.atob(sessionStorage.getItem(\"cartId\")),user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(cartDetails)};this.apiService.updateCart(updateCartData).subscribe(response=>{200===response.code&&(sessionStorage.removeItem(\"cart\"),this.apiService.getCartById(updateCartData.id).subscribe(response=>{200===response.code&&(this.products=JSON.parse(response.details.cart),this.insertImages(this.products),this.getProductQuantity(),this.findGrandTotal(),this.apiService.totalItemsInCart())}))})}})))}else if(\"cart\"===type){const updateCart={id:window.atob(sessionStorage.getItem(\"cartId\")),user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(cartArray)};this.subscribe.push(this.apiService.updateCart(updateCart).subscribe(res=>{200===res.code&&this.apiService.totalItemsInCart()}))}}getCartItems(){sessionStorage.getItem(\"cart\")?(this.products=JSON.parse(window.atob(sessionStorage.getItem(\"cart\"))),this.insertImages(this.products),this.findGrandTotal()):this.products=[]}findGrandTotal(){let productPrice=0;this.products.forEach(ele=>{ele.productQuantity&&(productPrice=(ele.discountPrice>0?ele.discountPrice:ele.price)*ele.productQuantity+productPrice)}),this.grandTotal=productPrice,this.shippingCharges=Math.round(+(.05*this.grandTotal).toFixed(3)),this.finalPrice=Math.round(this.grandTotal+this.shippingCharges),this.gstPrice=Math.round(+(.1*this.finalPrice).toFixed(3)),this.dealerDiscountAmount=Math.round(+(this.dealerDiscountPercentage*(this.finalPrice+this.gstPrice)).toFixed(3))}decrementProductQuantity(productCount){let productItemQuantity=this.products[productCount].productQuantity;if(productItemQuantity-=1,productItemQuantity<1){const show=document.getElementById(\"cartdeletemodal\");show.classList.add(\"in\"),show.style.display=\"block\",this.deleteItemIndex=productCount;const productId=this.products[this.deleteItemIndex].productId;if(\"product\"===this.products[this.deleteItemIndex].type){const productData=this.products.some(eachProduct=>\"accessory\"===eachProduct.type&&eachProduct.productId===productId);this.showDeleteMsg=!!productData}else this.showDeleteMsg=!1}else this.products[productCount].productQuantity=productItemQuantity,null===sessionStorage.getItem(\"id\")?sessionStorage.setItem(\"cart\",window.btoa(JSON.stringify(this.products))):this.updateCartDetails(this.products,\"cart\"),this.getProductQuantity();this.findGrandTotal()}removeItemFromCart(){let productIndex;if(this.deleteItemIndex>-1){const productId=this.products[this.deleteItemIndex].productId;\"product\"===this.products[this.deleteItemIndex].type&&(this.products=this.products.filter(eachProduct=>!(\"accessory\"===eachProduct.type&&eachProduct.productId===productId)),productIndex=this.products.findIndex(eachProduct=>eachProduct.productId===productId&&\"product\"===eachProduct.type)),void 0!==productIndex&&-1!==productIndex?(this.products.splice(productIndex,1),this.products.forEach(eachProduct=>{\"spare\"===eachProduct.type&&eachProduct.productId===productId&&(eachProduct.discountPrice=0)})):(this.products.splice(this.deleteItemIndex,1),this.products.forEach(eachProduct=>{\"spare\"===eachProduct.type&&eachProduct.productId===productId&&(eachProduct.discountPrice=0)}))}null===sessionStorage.getItem(\"id\")?sessionStorage.setItem(\"cart\",window.btoa(JSON.stringify(this.products))):this.updateCartDetails(this.products,\"cart\");const show=document.getElementById(\"cartdeletemodal\");show.classList.remove(\"in\"),show.style.display=\"none\",this.findGrandTotal(),this.apiService.totalItemsInCart()}closeDeleteModal(){const show=document.getElementById(\"cartdeletemodal\");show.classList.remove(\"in\"),show.style.display=\"none\"}incrementProductQuantity(productCount){let productTotal=this.products[productCount].productQuantity;productTotal++,this.products[productCount].productQuantity=productTotal,null===sessionStorage.getItem(\"id\")?sessionStorage.setItem(\"cart\",window.btoa(JSON.stringify(this.products))):this.updateCartDetails(this.products,\"cart\"),this.getProductQuantity(),this.findGrandTotal()}onContinue(type){sessionStorage.getItem(\"id\")&&\"continue\"===type?sessionStorage.getItem(\"cartId\")&&this.router.navigate([\"./deliveryAddress\"],{relativeTo:this.activatedRoute}):(sessionStorage.setItem(\"cart\",window.btoa(JSON.stringify(this.products))),\"sign-in\"===type&&this.router.navigate([\"/sign-in\"],{queryParams:{origin:\"cart\"}}))}redirect(type){\"sign-up\"===type?this.router.navigate([\"/sign-up\"],{queryParams:{origin:\"cart\"}}):\"sign-in\"===type&&this.router.navigate([\"/sign-in\"],{queryParams:{origin:\"cart\"}})}ngOnDestroy(){this.subscribe.forEach(sub=>{sub&&sub.unsubscribe()})}}return CartDetailsComponent.ɵfac=function(t){return new(t||CartDetailsComponent)(core[\"ɵɵdirectiveInject\"](api_service.a),core[\"ɵɵdirectiveInject\"](fesm2015_router.c),core[\"ɵɵdirectiveInject\"](fesm2015_router.a))},CartDetailsComponent.ɵcmp=core[\"ɵɵdefineComponent\"]({type:CartDetailsComponent,selectors:[[\"app-cart-details\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core[\"ɵɵviewQuery\"](_c0,!0),2&rf&&core[\"ɵɵqueryRefresh\"](_t=core[\"ɵɵloadQuery\"]())&&(ctx.inputList=_t.first)},decls:23,vars:5,consts:[[1,\"main-container\",\"cartpage\"],[1,\"breadcrum\"],[1,\"container\"],[\"href\",\"javascript:void(0)\",3,\"routerLink\"],[4,\"ngIf\"],[\"id\",\"cartdeletemodal\",\"role\",\"dialog\",1,\"modal\",\"fade\"],[1,\"modal-dialog\"],[1,\"modal-content\"],[1,\"modal-body\"],[1,\"delete-txt\"],[1,\"remove-sec\"],[\"style\",\"color: darkred;\",4,\"ngIf\"],[1,\"blue-button\",3,\"click\"],[1,\"cart-scale\"],[1,\"cart-scale-inner\"],[1,\"scale-no\",\"active-scale\"],[2,\"pointer-events\",\"none\"],[1,\"scale-no\"],[1,\"cart-section\"],[1,\"cart-inner\"],[1,\"cart\"],[1,\"price-title\"],[\"class\",\"cart-row cart-row-products\",4,\"ngFor\",\"ngForOf\"],[1,\"price-detail\"],[\"class\",\"price-row\",4,\"ngFor\",\"ngForOf\"],[1,\"price-row\",\"total-price\"],[1,\"left-price-spare\"],[\"class\",\"left-price-spare\",4,\"ngIf\"],[\"class\",\"sign-button-sec\",4,\"ngIf\"],[1,\"cart-row\",\"cart-row-products\"],[1,\"left-cart\"],[1,\"cart-pic\"],[\"height\",\"40px\",\"width\",\"40px\",3,\"src\"],[1,\"right-cart\"],[1,\"mid-cart\"],[1,\"number\"],[1,\"minus\",3,\"click\"],[\"type\",\"text\",\"appNumOnly\",\"\",\"disabled\",\"\",3,\"value\"],[1,\"plus\",3,\"click\"],[1,\"price-row\"],[\"class\",\"left-price\",4,\"ngIf\",\"ngIfElse\"],[\"productSpare\",\"\"],[1,\"right-price\"],[1,\"left-price\"],[1,\"sign-button-sec\"],[1,\"tooltip\",3,\"click\"],[1,\"tooltiptext\"],[\"href\",\"javascript:void(0)\",3,\"click\"],[1,\"epmtyCartImg\"],[\"src\",\"assets/images/icons/EmptyCart.svg\"],[\"class\",\"emptyCartMsg\",4,\"ngIf\"],[1,\"emptyCartMsg\"],[3,\"click\"],[2,\"color\",\"darkred\"]],template:function(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",0),core[\"ɵɵelementStart\"](1,\"div\",1),core[\"ɵɵelementStart\"](2,\"div\",2),core[\"ɵɵelementStart\"](3,\"p\"),core[\"ɵɵelementStart\"](4,\"a\",3),core[\"ɵɵtext\"](5,\"Home\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](6,\"span\"),core[\"ɵɵtext\"](7,\"/\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtext\"](8,\" Cart\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](9,CartDetailsComponent_ng_container_9_Template,52,8,\"ng-container\",4),core[\"ɵɵtemplate\"](10,CartDetailsComponent_ng_container_10_Template,5,2,\"ng-container\",4),core[\"ɵɵelementStart\"](11,\"div\",5),core[\"ɵɵelementStart\"](12,\"div\",6),core[\"ɵɵelementStart\"](13,\"div\",7),core[\"ɵɵelementStart\"](14,\"div\",8),core[\"ɵɵelementStart\"](15,\"div\",9),core[\"ɵɵelementStart\"](16,\"div\",10),core[\"ɵɵtext\"](17,\"Are you sure to remove this item? \"),core[\"ɵɵtemplate\"](18,CartDetailsComponent_p_18_Template,2,0,\"p\",11),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](19,\"button\",12),core[\"ɵɵlistener\"](\"click\",(function(){return ctx.removeItemFromCart()})),core[\"ɵɵtext\"](20,\"Yes\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](21,\"button\",12),core[\"ɵɵlistener\"](\"click\",(function(){return ctx.closeDeleteModal()})),core[\"ɵɵtext\"](22,\"Cancel\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf&&(core[\"ɵɵadvance\"](4),core[\"ɵɵproperty\"](\"routerLink\",core[\"ɵɵpureFunction0\"](4,_c1)),core[\"ɵɵadvance\"](5),core[\"ɵɵproperty\"](\"ngIf\",ctx.products.length>0),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",0==ctx.products.length),core[\"ɵɵadvance\"](8),core[\"ɵɵproperty\"](\"ngIf\",ctx.showDeleteMsg))},directives:[fesm2015_router.f,common.NgIf,common.NgForOf,numonly_directive.a],styles:[\"\"]}),CartDetailsComponent})();var ngx_spinner=__webpack_require__(\"JqCM\"),text_only_directive=__webpack_require__(\"ZSuO\");function CartAddressComponent_div_41_Template(rf,ctx){if(1&rf){const _r17=core[\"ɵɵgetCurrentView\"]();core[\"ɵɵelementStart\"](0,\"div\",17),core[\"ɵɵelementStart\"](1,\"input\",44),core[\"ɵɵlistener\"](\"change\",(function(){core[\"ɵɵrestoreView\"](_r17);const eachAddress_r14=ctx.$implicit;return core[\"ɵɵnextContext\"]().getSelectedAddress(eachAddress_r14)})),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](2,\"label\",45),core[\"ɵɵtext\"](3),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()}if(2&rf){const eachAddress_r14=ctx.$implicit,addressCount_r15=ctx.index;core[\"ɵɵadvance\"](1),core[\"ɵɵpropertyInterpolate\"](\"id\",\"address-\"+addressCount_r15),core[\"ɵɵproperty\"](\"checked\",0===addressCount_r15),core[\"ɵɵadvance\"](1),core[\"ɵɵpropertyInterpolate\"](\"for\",\"address-\"+addressCount_r15),core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate5\"](\"\",null==eachAddress_r14?null:eachAddress_r14.house_no,\" \",null==eachAddress_r14?null:eachAddress_r14.city,\" \",null==eachAddress_r14?null:eachAddress_r14.state,\" \",null==eachAddress_r14?null:eachAddress_r14.country,\" \",null==eachAddress_r14?null:eachAddress_r14.pincode,\"\")}}function CartAddressComponent_p_63_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\" Select title\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_71_p_1_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\"First name is required\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_71_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementContainerStart\"](0),core[\"ɵɵtemplate\"](1,CartAddressComponent_ng_container_71_p_1_Template,2,0,\"p\",28),core[\"ɵɵelementContainerEnd\"]()),2&rf){const ctx_r2=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",null==ctx_r2.formControl||null==ctx_r2.formControl.first_name?null:ctx_r2.formControl.first_name.errors.required)}}function CartAddressComponent_ng_container_82_p_1_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\"Last name is required\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_82_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementContainerStart\"](0),core[\"ɵɵtemplate\"](1,CartAddressComponent_ng_container_82_p_1_Template,2,0,\"p\",28),core[\"ɵɵelementContainerEnd\"]()),2&rf){const ctx_r3=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",null==ctx_r3.formControl||null==ctx_r3.formControl.last_name?null:ctx_r3.formControl.last_name.errors.required)}}function CartAddressComponent_ng_container_89_p_1_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\"Phone number is required\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_89_p_2_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\"Enter valid phone number\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_89_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementContainerStart\"](0),core[\"ɵɵtemplate\"](1,CartAddressComponent_ng_container_89_p_1_Template,2,0,\"p\",28),core[\"ɵɵtemplate\"](2,CartAddressComponent_ng_container_89_p_2_Template,2,0,\"p\",28),core[\"ɵɵelementContainerEnd\"]()),2&rf){const ctx_r4=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",null==ctx_r4.formControl||null==ctx_r4.formControl.phone?null:ctx_r4.formControl.phone.errors.required),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",null==ctx_r4.formControl||null==ctx_r4.formControl.phone?null:ctx_r4.formControl.phone.errors.pattern)}}function CartAddressComponent_p_98_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\" Address is required\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_option_105_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"option\",47),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachCountry_r22=ctx.$implicit;core[\"ɵɵpropertyInterpolate\"](\"value\",null==eachCountry_r22?null:eachCountry_r22.name),core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate\"](eachCountry_r22.name)}}function CartAddressComponent_p_106_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\" Select country from list\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_option_115_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"option\",47),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachState_r24=ctx.$implicit;core[\"ɵɵpropertyInterpolate\"](\"value\",null==eachState_r24?null:eachState_r24.name),core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\" \",eachState_r24.name,\"\")}}function CartAddressComponent_p_116_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\" Select state from list\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_option_125_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"option\",47),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachCity_r26=ctx.$implicit;core[\"ɵɵpropertyInterpolate\"](\"value\",null==eachCity_r26?null:eachCity_r26.name),core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\" \",eachCity_r26.name,\"\")}}function CartAddressComponent_p_126_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\" Select city\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_133_p_1_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\"Postal code is required\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_133_p_2_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",46),core[\"ɵɵtext\"](1,\"Enter valid postal code\"),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_ng_container_133_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementContainerStart\"](0),core[\"ɵɵtemplate\"](1,CartAddressComponent_ng_container_133_p_1_Template,2,0,\"p\",28),core[\"ɵɵtemplate\"](2,CartAddressComponent_ng_container_133_p_2_Template,2,0,\"p\",28),core[\"ɵɵelementContainerEnd\"]()),2&rf){const ctx_r12=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",null==ctx_r12.formControl||null==ctx_r12.formControl.pincode?null:ctx_r12.formControl.pincode.errors.required),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",null==ctx_r12.formControl||null==ctx_r12.formControl.pincode?null:ctx_r12.formControl.pincode.errors.pattern)}}function CartAddressComponent_div_136_div_3_div_1_p_3_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\"),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r34=core[\"ɵɵnextContext\"](2).$implicit;core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\"(\",null==eachProduct_r34?null:eachProduct_r34.driveType,\")\")}}function CartAddressComponent_div_136_div_3_div_1_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",59),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](3,CartAddressComponent_div_136_div_3_div_1_p_3_Template,2,1,\"p\",32),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r34=core[\"ɵɵnextContext\"]().$implicit;core[\"ɵɵadvance\"](2),core[\"ɵɵtextInterpolate\"](null==eachProduct_r34?null:eachProduct_r34.description),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"\"!==(null==eachProduct_r34?null:eachProduct_r34.driveType))}}function CartAddressComponent_div_136_div_3_ng_template_2_p_3_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\"),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r34=core[\"ɵɵnextContext\"](2).$implicit;core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\"(\",null==eachProduct_r34?null:eachProduct_r34.description,\")\")}}function CartAddressComponent_div_136_div_3_ng_template_2_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",59),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](3,CartAddressComponent_div_136_div_3_ng_template_2_p_3_Template,2,1,\"p\",32),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r34=core[\"ɵɵnextContext\"]().$implicit;core[\"ɵɵadvance\"](2),core[\"ɵɵtextInterpolate\"](null==eachProduct_r34?null:eachProduct_r34.code),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"\"!==(null==eachProduct_r34?null:eachProduct_r34.description))}}function CartAddressComponent_div_136_div_3_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",55),core[\"ɵɵtemplate\"](1,CartAddressComponent_div_136_div_3_div_1_Template,4,2,\"div\",56),core[\"ɵɵtemplate\"](2,CartAddressComponent_div_136_div_3_ng_template_2_Template,4,2,\"ng-template\",null,57,core[\"ɵɵtemplateRefExtractor\"]),core[\"ɵɵelementStart\"](4,\"div\",58),core[\"ɵɵelementStart\"](5,\"h3\"),core[\"ɵɵtext\"](6),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const eachProduct_r34=ctx.$implicit,_r36=core[\"ɵɵreference\"](3);core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",\"spare\"!==(null==eachProduct_r34?null:eachProduct_r34.type))(\"ngIfElse\",_r36),core[\"ɵɵadvance\"](5),core[\"ɵɵtextInterpolate1\"](\"$ \",(null==eachProduct_r34?null:eachProduct_r34.productQuantity)*((null==eachProduct_r34?null:eachProduct_r34.discountPrice)>0?null==eachProduct_r34?null:eachProduct_r34.discountPrice:null==eachProduct_r34?null:eachProduct_r34.price),\"\")}}function CartAddressComponent_div_136_div_22_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",52),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2,\"Dealer Discount (10%) \"),core[\"ɵɵelement\"](3,\"br\"),core[\"ɵɵtext\"](4,\" (In AUD)\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](5,\"h3\"),core[\"ɵɵtext\"](6),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r31=core[\"ɵɵnextContext\"](2);core[\"ɵɵadvance\"](6),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r31.finalPrice+ctx_r31.gstPrice-ctx_r31.dealerDiscountAmount,\"\")}}function CartAddressComponent_div_136_button_23_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"button\",60),core[\"ɵɵelementStart\"](1,\"a\",61),core[\"ɵɵtext\"](2,\"Checkout \"),core[\"ɵɵelementStart\"](3,\"span\",62),core[\"ɵɵtext\"](4,\"Please enter your address to continue\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]())}function CartAddressComponent_div_136_button_24_Template(rf,ctx){if(1&rf){const _r45=core[\"ɵɵgetCurrentView\"]();core[\"ɵɵelementStart\"](0,\"button\"),core[\"ɵɵelementStart\"](1,\"a\",63),core[\"ɵɵlistener\"](\"click\",(function(){return core[\"ɵɵrestoreView\"](_r45),core[\"ɵɵnextContext\"](2).checkOut()})),core[\"ɵɵtext\"](2,\"Checkout\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()}}function CartAddressComponent_div_136_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",48),core[\"ɵɵelementStart\"](1,\"h3\",49),core[\"ɵɵtext\"](2,\"Price Detail\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](3,CartAddressComponent_div_136_div_3_Template,7,3,\"div\",50),core[\"ɵɵelementStart\"](4,\"div\",51),core[\"ɵɵelementStart\"](5,\"div\",52),core[\"ɵɵelementStart\"](6,\"h3\"),core[\"ɵɵtext\"](7,\"Sub Total\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](8,\"h3\"),core[\"ɵɵtext\"](9),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](10,\"div\",52),core[\"ɵɵelementStart\"](11,\"h3\"),core[\"ɵɵtext\"](12,\"Shipping & Handling\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](13,\"h3\"),core[\"ɵɵtext\"](14),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](15,\"div\",52),core[\"ɵɵelementStart\"](16,\"h3\"),core[\"ɵɵtext\"](17,\"Total (including GST@10%) \"),core[\"ɵɵelement\"](18,\"br\"),core[\"ɵɵtext\"](19,\"(In AUD)\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](20,\"h3\"),core[\"ɵɵtext\"](21),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](22,CartAddressComponent_div_136_div_22_Template,7,1,\"div\",53),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](23,CartAddressComponent_div_136_button_23_Template,5,0,\"button\",54),core[\"ɵɵtemplate\"](24,CartAddressComponent_div_136_button_24_Template,3,0,\"button\",32),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r13=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"ngForOf\",ctx_r13.products),core[\"ɵɵadvance\"](6),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r13.grandTotal,\"\"),core[\"ɵɵadvance\"](5),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r13.shippingCharges,\"\"),core[\"ɵɵadvance\"](7),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r13.finalPrice+ctx_r13.gstPrice,\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx_r13.applyDealerDiscount),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx_r13.emptyAddress),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",!ctx_r13.emptyAddress)}}const cart_address_component_c0=function(){return[\"/home\"]},cart_address_component_c1=function(){return[\"/cart\"]},_c2=function(a0){return{display:a0}};let cart_address_component_CartAddressComponent=(()=>{class CartAddressComponent{constructor(apiService,fb,toaster,route,spinner){this.apiService=apiService,this.fb=fb,this.toaster=toaster,this.route=route,this.spinner=spinner,this.products=[],this.grandTotal=0,this.shippingCharges=0,this.finalPrice=0,this.toggleAddress=\"\",this.subscribe=[],this.emptyAddress=!1,this.stateInfo=[],this.countryInfo=[],this.cityInfo=[],this.buyNowCartId=\"\",this.toggleCanDeactivate=!0,this.applyDealerDiscount=!1,this.dealerDiscountAmount=0}ngOnInit(){if(this.spinner.show(),sessionStorage.getItem(\"id\")&&(this.userId=window.atob(sessionStorage.getItem(\"id\")),this.getAddressList(window.atob(sessionStorage.getItem(\"id\")))),\"Dealer\"===window.atob(sessionStorage.getItem(\"userType\"))&&\"D\"===window.atob(sessionStorage.getItem(\"userStatus\")))if(this.applyDealerDiscount=!0,null===window.atob(sessionStorage.getItem(\"userDiscount\")))this.apiService.dealerDiscount().subscribe(res=>{!0===res.return&&(this.dealerDiscountPercentage=res.dealer_discount,this.dealerDiscountPercentage=.01*this.dealerDiscountPercentage)});else{let userDiscount=window.atob(sessionStorage.getItem(\"userDiscount\"));this.dealerDiscountPercentage=.01*+userDiscount}if(sessionStorage.getItem(\"buyNow\")){this.getCartItems();const cartData={user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(this.products)};this.apiService.addToCart(cartData).subscribe(res=>{200===res.code&&(this.buyNowCartId=res.cart_details.id)})}else this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem(\"cartId\"))).subscribe(res=>{200===res.code&&(this.products=JSON.parse(res.details.cart),this.findGrandTotal())},err=>{var _a;this.toaster.error((null===(_a=null==err?void 0:err.error)||void 0===_a?void 0:_a.message)||(null==err?void 0:err.message))}));this.getCountries(),this.createAddressForm()}getSelectedAddress(address){\"newAddress\"!==address?(this.selectedAddress=address,this.toggleAddress=\"\",this.emptyAddress=!1):(this.toggleAddress=\"newAddress\",this.emptyAddress=!0,this.getUserDetails(this.userId))}getCartItems(){this.products=JSON.parse(window.atob(sessionStorage.getItem(\"buyNow\"))),this.findGrandTotal()}findGrandTotal(){let productPrice=0;this.products.forEach(ele=>{ele.productQuantity&&(productPrice=(ele.discountPrice>0?ele.discountPrice:ele.price)*ele.productQuantity+productPrice)}),this.grandTotal=productPrice,this.shippingCharges=Math.round(+(.05*this.grandTotal).toFixed(3)),this.finalPrice=Math.round(this.grandTotal+this.shippingCharges),this.gstPrice=Math.round(+(.1*this.finalPrice).toFixed(3)),this.dealerDiscountAmount=Math.round(+(this.dealerDiscountPercentage*(this.finalPrice+this.gstPrice)).toFixed(3));const additionalPaymentDetails=window.btoa(JSON.stringify({subtotal_amount:this.grandTotal,shipping_amount:this.shippingCharges,gst_amount:this.gstPrice}));sessionStorage.setItem(\"additionalPaymentDetails\",additionalPaymentDetails)}getCountries(){this.subscribe.push(this.apiService.getCountryData().subscribe(res=>{res&&(this.countryInfo=res.countries,this.onChangeCountry(\"Australia\"))}))}getAddressList(userId){this.subscribe.push(this.apiService.getAllAddress({user_id:+userId}).subscribe(res=>{200===res.code&&(this.addressList=res.address,this.spinner.hide(),this.addressList.length>0?(this.selectedAddress=res.address[0],this.emptyAddress=!1):(this.emptyAddress=!0,this.getSelectedAddress(\"newAddress\")))},err=>{this.toaster.error(\"No address found\"),this.spinner.hide()}))}getUserDetails(userId){this.apiService.getUserDetails(userId).subscribe(res=>{res.code&&this.patchAddressForm(res.details.name)})}patchAddressForm(userName){const name=userName.split(\" \");3===name.length?this.addressForm.patchValue({first_name:name[0],middle_name:name[1],last_name:name[2]}):name.length>1&&name.length<=2?this.addressForm.patchValue({first_name:name[0],last_name:name[1]}):1===name.length&&this.addressForm.patchValue({first_name:name[0]})}onChangeCountry(countryValue){this.cityInfo=[];const countryIndex=this.countryInfo.findIndex(res=>res.name===countryValue);this.stateInfo=this.countryInfo[countryIndex].states}onChangeState(stateValue){const stateIndex=this.stateInfo.findIndex(res=>res.name===stateValue);this.cityInfo=this.stateInfo[stateIndex].cities}createAddressForm(){this.addressForm=this.fb.group({title:new fesm2015_forms.c(\"\",fesm2015_forms.q.required),first_name:new fesm2015_forms.c(\"\",fesm2015_forms.q.required),middle_name:new fesm2015_forms.c(\"\"),last_name:new fesm2015_forms.c(\"\",fesm2015_forms.q.required),phone:new fesm2015_forms.c(\"\",[fesm2015_forms.q.pattern(\"[0-9 ]{10,12}\"),fesm2015_forms.q.required]),house_no:new fesm2015_forms.c(\"\",fesm2015_forms.q.required),city:new fesm2015_forms.c(\"\",fesm2015_forms.q.required),state:new fesm2015_forms.c(\"\",fesm2015_forms.q.required),pincode:new fesm2015_forms.c(\"\",[fesm2015_forms.q.pattern(\"[0-9 ]{4}\"),fesm2015_forms.q.required]),country:new fesm2015_forms.c(\"Australia\",fesm2015_forms.q.required)})}get formControl(){return this.addressForm.controls}onInputChange(validNumber,type){let maxLength=0;\"phone\"===type?(maxLength=12,validNumber.length>=maxLength&&this.addressForm.patchValue({phone:validNumber.substring(0,12)})):\"zip\"===type&&(maxLength=4,validNumber.length>=maxLength&&this.addressForm.patchValue({pincode:validNumber.substring(0,4)}))}validateAllFields(formGroup){Object.keys(this.formControl).forEach(field=>{const control=formGroup.get(field);control instanceof fesm2015_forms.c?control.markAsTouched({onlySelf:!0}):control instanceof fesm2015_forms.e&&this.validateAllFields(control)})}saveAddress(form){form.invalid?this.validateAllFields(form):(form.value.user_id=+this.userId,this.subscribe.push(this.apiService.addAddress(form.value).subscribe(res=>{200===res.code&&(this.toaster.success(res.message),this.getAddressList(this.userId),this.toggleAddress=\"\",form.reset())},err=>{var _a;this.toaster.error((null===(_a=null==err?void 0:err.error)||void 0===_a?void 0:_a.message)||(null==err?void 0:err.message))})))}updateCart(){const cartLocalData=JSON.parse(window.atob(sessionStorage.getItem(\"buyNow\")));let cart;console.log(cartLocalData,\"cartLocal\");const accessoriesToAdd=[],sparesToAdd=[];null!==cartLocalData&&cartLocalData.forEach(cartData=>{\"product\"===cartData.type?cart=new cart_details.a(cartData.productId,cartData.code,cartData.description,cartData.price,cartData.discountPrice,cartData.type,cartData.pole,cartData.flow,cartData.head,cartData.speed,cartData.power,cartData.engineSpeed,cartData.enginekW,cartData.driveType,cartData.productQuantity):\"accessory\"===cartData.type?accessoriesToAdd.push(cartData):\"spare\"===cartData.type&&sparesToAdd.push(cartData)}),this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem(\"cartId\"))).subscribe(res=>{if(200===res.code){let cartDetails=[];if(cartDetails=JSON.parse(res.details.cart),console.log(cartDetails,\"cartDetails\"),cartDetails.length<=0)cartDetails.push(cart),cartDetails.push(...accessoriesToAdd),cartDetails.push(...sparesToAdd);else{const cartAccessoryDataSet=new Array,cartSpareDataSet=new Array;let cartProductDataSet,spareNotExist=!0,accessoryNotExist=!0;for(let i=0;i<cartDetails.length;i++)if(\"product\"===cartDetails[i].type)cartDetails[i].driveType===cart.driveType&&cartDetails[i].code===cart.code&&cartDetails[i].pole===cart.pole?cartDetails[i].productQuantity++:cartProductDataSet=cart;else if(\"accessory\"===cartDetails[i].type){accessoryNotExist=!1;for(let j=0;j<accessoriesToAdd.length;j++)accessoriesToAdd[j].description===cartDetails[i].description&&accessoriesToAdd[j].pole===cartDetails[i].pole&&accessoriesToAdd[j].driveType===cartDetails[i].driveType?cartDetails[i].productQuantity++:cartDetails.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.push(accessoriesToAdd[j])}else if(\"spare\"===cartDetails[i].type){spareNotExist=!1;for(let j=0;j<sparesToAdd.length;j++)sparesToAdd[j].description===cartDetails[i].description&&sparesToAdd[j].pole===cartDetails[i].pole&&sparesToAdd[j].driveType===cartDetails[i].driveType?cartDetails[i].productQuantity++:cartDetails.some(res=>res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===sparesToAdd[j].driveType)||cartSpareDataSet.some(res=>res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===sparesToAdd[j].driveType)||cartSpareDataSet.push(sparesToAdd[j])}cartAccessoryDataSet.length>0&&cartDetails.push(...cartAccessoryDataSet),cartSpareDataSet.length>0&&cartDetails.push(...cartSpareDataSet),cartProductDataSet.length>0&&(cartDetails.push(cartProductDataSet),console.log(cartDetails,\"push\")),accessoryNotExist&&cartDetails.push(...accessoriesToAdd),spareNotExist&&cartDetails.push(...sparesToAdd)}const updateCart={id:window.atob(sessionStorage.getItem(\"cartId\")),user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(cartDetails)};return this.subscribe.push(this.apiService.updateCart(updateCart).subscribe(response=>{200===response.code&&(this.buyNowCartId=updateCart.id,sessionStorage.removeItem(\"buyNow\"),this.apiService.totalItemsInCart())}))}}))}checkOut(){var _a,_b;\"\"===this.toggleAddress?(this.toggleCanDeactivate=!1,this.route.navigate(\"\"!==this.buyNowCartId?[\"/cart/payment\",null===(_a=this.selectedAddress)||void 0===_a?void 0:_a.id,this.buyNowCartId]:[\"/cart/payment\",null===(_b=this.selectedAddress)||void 0===_b?void 0:_b.id,window.atob(sessionStorage.getItem(\"cartId\"))])):this.toaster.success(\"Please add and select one address to continue\")}canDeactivate(){if(this.toggleCanDeactivate){if(sessionStorage.getItem(\"cartId\")){if(sessionStorage.getItem(\"buyNow\")){const cartLocalData=JSON.parse(window.atob(sessionStorage.getItem(\"buyNow\"))),accessoriesToAdd=[],sparesToAdd=[];let cart;return null!==cartLocalData&&cartLocalData.forEach(cartData=>{\"product\"===cartData.type?cart=new cart_details.a(cartData.productId,cartData.code,cartData.description,cartData.price,cartData.discountPrice,cartData.type,cartData.pole,cartData.flow,cartData.head,cartData.speed,cartData.power,cartData.engineSpeed,cartData.enginekW,cartData.driveType,cartData.productQuantity):\"accessory\"===cartData.type?accessoriesToAdd.push(cartData):\"spare\"===cartData.type&&sparesToAdd.push(cartData)}),new Promise(resolve=>{this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem(\"cartId\"))).subscribe(res=>{if(200===res.code){let cartDetails=[];if(cartDetails=JSON.parse(res.details.cart),console.log(\"cartDetails\",cartDetails),cartDetails.length<=0)cartDetails.push(Object.assign({},cart)),cartDetails.push(...accessoriesToAdd),cartDetails.push(...sparesToAdd);else{const cartAccessoryDataSet=new Array,cartSpareDataSet=new Array;let cartProductDataSet={},spareNotExist=!0,accessoryNotExist=!0,cartNotExist=!0;for(let i=0;i<cartDetails.length;i++)if(\"product\"===cartDetails[i].type)cartNotExist=!1,(\"\"===cartDetails[i].driveType||cartDetails[i].driveType)===(\"\"===cart.driveType||cart.driveType)&&cartDetails[i].code===cart.code&&cartDetails[i].pole===cart.pole?cartDetails[i].productQuantity++:cartProductDataSet=cart;else if(\"accessory\"===cartDetails[i].type){accessoryNotExist=!1;for(let j=0;j<accessoriesToAdd.length;j++)accessoriesToAdd[j].description===cartDetails[i].description&&accessoriesToAdd[j].pole===cartDetails[i].pole&&accessoriesToAdd[j].driveType===cartDetails[i].driveType?cartDetails[i].productQuantity++:cartDetails.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.push(accessoriesToAdd[j])}else if(\"spare\"===cartDetails[i].type){spareNotExist=!1;for(let j=0;j<sparesToAdd.length;j++)sparesToAdd[j].description===cartDetails[i].description&&sparesToAdd[j].pole===cartDetails[i].pole&&sparesToAdd[j].driveType===cartDetails[i].driveType?cartDetails[i].productQuantity++:cartDetails.some(res=>res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===sparesToAdd[j].driveType)||cartSpareDataSet.some(res=>res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===sparesToAdd[j].driveType)||cartSpareDataSet.push(sparesToAdd[j])}cartAccessoryDataSet.length>0&&cartDetails.push(...cartAccessoryDataSet),cartSpareDataSet.length>0&&cartDetails.push(...cartSpareDataSet),Object.keys(cartProductDataSet).length>0&&cartDetails.push(Object.assign({},cartProductDataSet)),accessoryNotExist&&cartDetails.push(...accessoriesToAdd),spareNotExist&&cartDetails.push(...sparesToAdd),cartNotExist&&cartDetails.push(Object.assign({},cart))}const updateCart={id:window.atob(sessionStorage.getItem(\"cartId\")),user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(cartDetails)};return console.log(cartDetails,\"ooo\"),this.subscribe.push(this.apiService.updateCart(updateCart).subscribe(response=>{if(200===response.code)return sessionStorage.removeItem(\"buyNow\"),this.apiService.totalItemsInCart(),resolve(!0)}))}}))})}return!0}return sessionStorage.setItem(\"cartId\",window.btoa(this.buyNowCartId)),this.apiService.totalItemsInCart(),sessionStorage.removeItem(\"buyNow\"),!0}return!0}ngOnDestroy(){this.subscribe.forEach(s=>{s&&s.unsubscribe()})}}return CartAddressComponent.ɵfac=function(t){return new(t||CartAddressComponent)(core[\"ɵɵdirectiveInject\"](api_service.a),core[\"ɵɵdirectiveInject\"](fesm2015_forms.b),core[\"ɵɵdirectiveInject\"](ngx_toastr.b),core[\"ɵɵdirectiveInject\"](fesm2015_router.c),core[\"ɵɵdirectiveInject\"](ngx_spinner.c))},CartAddressComponent.ɵcmp=core[\"ɵɵdefineComponent\"]({type:CartAddressComponent,selectors:[[\"app-cart-address\"]],decls:137,vars:33,consts:[[\"bdColor\",\"rgb(0,0,0)\",\"size\",\"medium\",\"color\",\"#2e94ef\",\"type\",\"ball-newton-cradle\",3,\"fullScreen\"],[2,\"color\",\"white\"],[1,\"main-container\",\"cartpage\",\"addresspage\"],[1,\"breadcrum\"],[1,\"container\"],[\"href\",\"javascript:void(0)\",3,\"routerLink\"],[1,\"cart-scale\"],[1,\"cart-scale-inner\"],[1,\"scale-no\",\"active-scale\"],[2,\"pointer-events\",\"none\"],[1,\"scale-no\"],[1,\"cart-section\"],[1,\"cart-inner\"],[1,\"cart\"],[1,\"address-row\",\"same-add-row\"],[1,\"same-address\"],[\"class\",\"address-box\",4,\"ngFor\",\"ngForOf\"],[1,\"address-box\"],[\"type\",\"radio\",\"name\",\"address\",\"id\",\"address\",3,\"checked\",\"change\"],[\"for\",\"address\"],[1,\"address-row\",3,\"ngStyle\"],[3,\"formGroup\"],[1,\"address-feild\"],[\"formControlName\",\"title\",\"required\",\"\",3,\"ngClass\"],[\"value\",\"\",\"selected\",\"\",\"disabled\",\"\"],[\"value\",\"Mr\"],[\"value\",\"Ms\"],[\"value\",\" \"],[\"class\",\"error-addressMsg\",4,\"ngIf\"],[1,\"name-container\"],[1,\"address-feild\",\"address2\"],[\"type\",\"text\",\"placeholder\",\"First Name\",\"formControlName\",\"first_name\",\"appTextOnly\",\"\",\"required\",\"\",3,\"ngClass\"],[4,\"ngIf\"],[\"type\",\"text\",\"placeholder\",\"Middle Name\",\"appTextOnly\",\"\",\"formControlName\",\"middle_name\"],[\"type\",\"text\",\"placeholder\",\"Last Name\",\"formControlName\",\"last_name\",\"appTextOnly\",\"\",\"required\",\"\",3,\"ngClass\"],[\"type\",\"text\",\"placeholder\",\"Contact Number\",\"appNumOnly\",\"\",\"formControlName\",\"phone\",\"required\",\"\",3,\"ngClass\",\"input\"],[\"type\",\"text\",\"placeholder\",\"Address\",\"formControlName\",\"house_no\",\"required\",\"\",3,\"ngClass\"],[\"formControlName\",\"country\",\"required\",\"\",3,\"ngClass\",\"change\"],[3,\"value\",4,\"ngFor\",\"ngForOf\"],[\"formControlName\",\"state\",\"required\",\"\",3,\"ngClass\",\"change\"],[\"formControlName\",\"city\",\"required\",\"\",3,\"ngClass\"],[\"type\",\"text\",\"placeholder\",\"1234\",\"appNumOnly\",\"\",\"formControlName\",\"pincode\",\"required\",\"\",3,\"ngClass\",\"input\"],[1,\"blue-button\",3,\"click\"],[\"class\",\"price-detail\",4,\"ngIf\"],[\"type\",\"radio\",\"name\",\"address\",3,\"id\",\"checked\",\"change\"],[3,\"for\"],[1,\"error-addressMsg\"],[3,\"value\"],[1,\"price-detail\"],[1,\"price-title\"],[\"class\",\"price-row\",4,\"ngFor\",\"ngForOf\"],[1,\"price-row\",\"total-price\"],[1,\"left-price-spare\"],[\"class\",\"left-price-spare\",4,\"ngIf\"],[\"disabled\",\"\",4,\"ngIf\"],[1,\"price-row\"],[\"class\",\"left-price\",4,\"ngIf\",\"ngIfElse\"],[\"productSpare\",\"\"],[1,\"right-price\"],[1,\"left-price\"],[\"disabled\",\"\"],[1,\"tooltip\"],[1,\"tooltiptext\"],[1,\"tooltip\",3,\"click\"]],template:function(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"ngx-spinner\",0),core[\"ɵɵelementStart\"](1,\"p\",1),core[\"ɵɵtext\"](2,\" Loading... \"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](3,\"div\",2),core[\"ɵɵelementStart\"](4,\"div\",3),core[\"ɵɵelementStart\"](5,\"div\",4),core[\"ɵɵelementStart\"](6,\"p\"),core[\"ɵɵelementStart\"](7,\"a\",5),core[\"ɵɵtext\"](8,\"Home\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtext\"](9,\" / \"),core[\"ɵɵelementStart\"](10,\"a\",5),core[\"ɵɵtext\"](11,\"Cart\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](12,\"span\"),core[\"ɵɵtext\"](13,\"/\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtext\"](14,\" Address\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](15,\"div\",6),core[\"ɵɵelementStart\"](16,\"div\",4),core[\"ɵɵelementStart\"](17,\"div\",7),core[\"ɵɵelementStart\"](18,\"div\",8),core[\"ɵɵelementStart\"](19,\"a\",9),core[\"ɵɵtext\"](20,\"1\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](21,\"small\"),core[\"ɵɵtext\"](22,\"Cart\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](23,\"div\",10),core[\"ɵɵelementStart\"](24,\"a\",9),core[\"ɵɵtext\"](25,\"2\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](26,\"small\"),core[\"ɵɵtext\"](27,\"Address\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](28,\"div\",10),core[\"ɵɵelementStart\"](29,\"a\",9),core[\"ɵɵtext\"](30,\"3\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](31,\"small\"),core[\"ɵɵtext\"](32,\"Payment\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](33,\"div\",11),core[\"ɵɵelementStart\"](34,\"div\",4),core[\"ɵɵelementStart\"](35,\"div\",12),core[\"ɵɵelementStart\"](36,\"div\",13),core[\"ɵɵelementStart\"](37,\"div\",14),core[\"ɵɵelementStart\"](38,\"h3\"),core[\"ɵɵtext\"](39,\"Use saved addresses\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](40,\"div\",15),core[\"ɵɵtemplate\"](41,CartAddressComponent_div_41_Template,4,8,\"div\",16),core[\"ɵɵelementStart\"](42,\"div\",17),core[\"ɵɵelementStart\"](43,\"input\",18),core[\"ɵɵlistener\"](\"change\",(function(){return ctx.getSelectedAddress(\"newAddress\")})),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](44,\"label\",19),core[\"ɵɵtext\"](45,\"New Address\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](46,\"div\",20),core[\"ɵɵelementStart\"](47,\"h3\"),core[\"ɵɵtext\"](48,\"Contact Detail\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](49,\"form\",21),core[\"ɵɵelementStart\"](50,\"div\",22),core[\"ɵɵelementStart\"](51,\"label\"),core[\"ɵɵtext\"](52,\"Title \"),core[\"ɵɵelementStart\"](53,\"span\"),core[\"ɵɵtext\"](54,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](55,\"select\",23),core[\"ɵɵelementStart\"](56,\"option\",24),core[\"ɵɵtext\"](57,\"Select title\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](58,\"option\",25),core[\"ɵɵtext\"](59,\"Mr.\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](60,\"option\",26),core[\"ɵɵtext\"](61,\"Ms.\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](62,\"option\",27),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](63,CartAddressComponent_p_63_Template,2,0,\"p\",28),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](64,\"div\",29),core[\"ɵɵelementStart\"](65,\"div\",30),core[\"ɵɵelementStart\"](66,\"label\"),core[\"ɵɵtext\"](67,\"First Name\"),core[\"ɵɵelementStart\"](68,\"span\"),core[\"ɵɵtext\"](69,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](70,\"input\",31),core[\"ɵɵtemplate\"](71,CartAddressComponent_ng_container_71_Template,2,1,\"ng-container\",32),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](72,\"div\",30),core[\"ɵɵelementStart\"](73,\"label\"),core[\"ɵɵtext\"](74,\"Middle Name\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](75,\"input\",33),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](76,\"div\",30),core[\"ɵɵelementStart\"](77,\"label\"),core[\"ɵɵtext\"](78,\"Last Name \"),core[\"ɵɵelementStart\"](79,\"span\"),core[\"ɵɵtext\"](80,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](81,\"input\",34),core[\"ɵɵtemplate\"](82,CartAddressComponent_ng_container_82_Template,2,1,\"ng-container\",32),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](83,\"div\",22),core[\"ɵɵelementStart\"](84,\"label\"),core[\"ɵɵtext\"](85,\"Contact Number \"),core[\"ɵɵelementStart\"](86,\"span\"),core[\"ɵɵtext\"](87,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](88,\"input\",35),core[\"ɵɵlistener\"](\"input\",(function($event){return ctx.onInputChange($event.target.value,\"phone\")})),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](89,CartAddressComponent_ng_container_89_Template,3,2,\"ng-container\",32),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](90,\"h3\"),core[\"ɵɵtext\"](91,\"Address\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](92,\"div\",22),core[\"ɵɵelementStart\"](93,\"label\"),core[\"ɵɵtext\"](94,\"Address (House No., Building , Street, Area) \"),core[\"ɵɵelementStart\"](95,\"span\"),core[\"ɵɵtext\"](96,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](97,\"input\",36),core[\"ɵɵtemplate\"](98,CartAddressComponent_p_98_Template,2,0,\"p\",28),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](99,\"div\",22),core[\"ɵɵelementStart\"](100,\"label\"),core[\"ɵɵtext\"](101,\"Country \"),core[\"ɵɵelementStart\"](102,\"span\"),core[\"ɵɵtext\"](103,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](104,\"select\",37),core[\"ɵɵlistener\"](\"change\",(function($event){return ctx.onChangeCountry($event.target.value)})),core[\"ɵɵtemplate\"](105,CartAddressComponent_option_105_Template,2,2,\"option\",38),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](106,CartAddressComponent_p_106_Template,2,0,\"p\",28),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](107,\"div\",22),core[\"ɵɵelementStart\"](108,\"label\"),core[\"ɵɵtext\"](109,\"State \"),core[\"ɵɵelementStart\"](110,\"span\"),core[\"ɵɵtext\"](111,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](112,\"select\",39),core[\"ɵɵlistener\"](\"change\",(function($event){return ctx.onChangeState($event.target.value)})),core[\"ɵɵelementStart\"](113,\"option\",24),core[\"ɵɵtext\"](114,\"Please select state\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](115,CartAddressComponent_option_115_Template,2,2,\"option\",38),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](116,CartAddressComponent_p_116_Template,2,0,\"p\",28),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](117,\"div\",22),core[\"ɵɵelementStart\"](118,\"label\"),core[\"ɵɵtext\"](119,\"City \"),core[\"ɵɵelementStart\"](120,\"span\"),core[\"ɵɵtext\"](121,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](122,\"select\",40),core[\"ɵɵelementStart\"](123,\"option\",24),core[\"ɵɵtext\"](124,\"Please select state first\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](125,CartAddressComponent_option_125_Template,2,2,\"option\",38),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](126,CartAddressComponent_p_126_Template,2,0,\"p\",28),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](127,\"div\",22),core[\"ɵɵelementStart\"](128,\"label\"),core[\"ɵɵtext\"](129,\"Postal code\"),core[\"ɵɵelementStart\"](130,\"span\"),core[\"ɵɵtext\"](131,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](132,\"input\",41),core[\"ɵɵlistener\"](\"input\",(function($event){return ctx.onInputChange($event.target.value,\"zip\")})),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](133,CartAddressComponent_ng_container_133_Template,3,2,\"ng-container\",32),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](134,\"div\",42),core[\"ɵɵlistener\"](\"click\",(function(){return ctx.saveAddress(ctx.addressForm)})),core[\"ɵɵtext\"](135,\"Save this address\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](136,CartAddressComponent_div_136_Template,25,7,\"div\",43),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf&&(core[\"ɵɵproperty\"](\"fullScreen\",!0),core[\"ɵɵadvance\"](7),core[\"ɵɵproperty\"](\"routerLink\",core[\"ɵɵpureFunction0\"](29,cart_address_component_c0)),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"routerLink\",core[\"ɵɵpureFunction0\"](30,cart_address_component_c1)),core[\"ɵɵadvance\"](31),core[\"ɵɵproperty\"](\"ngForOf\",ctx.addressList),core[\"ɵɵadvance\"](2),core[\"ɵɵproperty\"](\"checked\",ctx.emptyAddress),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"ngStyle\",core[\"ɵɵpureFunction1\"](31,_c2,\"newAddress\"===ctx.toggleAddress?\"flex\":\"none\")),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"formGroup\",ctx.addressForm),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",null!=ctx.formControl&&null!=ctx.formControl.title&&ctx.formControl.title.invalid&&(null!=ctx.formControl&&null!=ctx.formControl.title&&ctx.formControl.title.touched||null!=ctx.formControl&&null!=ctx.formControl.title&&ctx.formControl.title.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.title&&ctx.formControl.title.valid&&(null!=ctx.formControl&&null!=ctx.formControl.title&&ctx.formControl.title.touched||null!=ctx.formControl&&null!=ctx.formControl.title&&ctx.formControl.title.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](8),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.title?null:ctx.formControl.title.invalid)&&((null==ctx.formControl||null==ctx.formControl.title?null:ctx.formControl.title.touched)||(null==ctx.formControl||null==ctx.formControl.title?null:ctx.formControl.title.dirty))),core[\"ɵɵadvance\"](7),core[\"ɵɵproperty\"](\"ngClass\",null!=ctx.formControl&&null!=ctx.formControl.first_name&&null!=ctx.formControl.first_name.errors&&ctx.formControl.first_name.errors.required&&(null!=ctx.formControl&&null!=ctx.formControl.first_name&&ctx.formControl.first_name.touched||null!=ctx.formControl&&null!=ctx.formControl.first_name&&ctx.formControl.first_name.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.first_name&&ctx.formControl.first_name.valid&&(null!=ctx.formControl&&null!=ctx.formControl.first_name&&ctx.formControl.first_name.touched||null!=ctx.formControl&&null!=ctx.formControl.first_name&&ctx.formControl.first_name.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.first_name?null:ctx.formControl.first_name.invalid)&&((null==ctx.formControl||null==ctx.formControl.first_name?null:ctx.formControl.first_name.touched)||(null==ctx.formControl||null==ctx.formControl.first_name?null:ctx.formControl.first_name.dirty))),core[\"ɵɵadvance\"](10),core[\"ɵɵproperty\"](\"ngClass\",null!=ctx.formControl&&null!=ctx.formControl.last_name&&null!=ctx.formControl.last_name.errors&&ctx.formControl.last_name.errors.required&&(null!=ctx.formControl&&null!=ctx.formControl.last_name&&ctx.formControl.last_name.touched||null!=ctx.formControl&&null!=ctx.formControl.last_name&&ctx.formControl.last_name.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.last_name&&ctx.formControl.last_name.valid&&(null!=ctx.formControl&&null!=ctx.formControl.last_name&&ctx.formControl.last_name.touched||null!=ctx.formControl&&null!=ctx.formControl.last_name&&ctx.formControl.last_name.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.last_name?null:ctx.formControl.last_name.invalid)&&((null==ctx.formControl||null==ctx.formControl.last_name?null:ctx.formControl.last_name.touched)||(null==ctx.formControl||null==ctx.formControl.last_name?null:ctx.formControl.last_name.dirty))),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",(null!=ctx.formControl&&null!=ctx.formControl.phone&&null!=ctx.formControl.phone.errors&&ctx.formControl.phone.errors.required||null!=ctx.formControl&&null!=ctx.formControl.phone&&null!=ctx.formControl.phone.errors&&ctx.formControl.phone.errors.pattern)&&(null!=ctx.formControl&&null!=ctx.formControl.phone&&ctx.formControl.phone.touched||null!=ctx.formControl&&null!=ctx.formControl.phone&&ctx.formControl.phone.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.phone&&ctx.formControl.phone.valid&&(null!=ctx.formControl&&null!=ctx.formControl.phone&&ctx.formControl.phone.touched||null!=ctx.formControl&&null!=ctx.formControl.phone&&ctx.formControl.phone.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.phone?null:ctx.formControl.phone.invalid)&&((null==ctx.formControl||null==ctx.formControl.phone?null:ctx.formControl.phone.touched)||(null==ctx.formControl||null==ctx.formControl.phone?null:ctx.formControl.phone.dirty))),core[\"ɵɵadvance\"](8),core[\"ɵɵproperty\"](\"ngClass\",null!=ctx.formControl&&null!=ctx.formControl.house_no&&ctx.formControl.house_no.invalid&&(null!=ctx.formControl&&null!=ctx.formControl.house_no&&ctx.formControl.house_no.touched||null!=ctx.formControl&&null!=ctx.formControl.house_no&&ctx.formControl.house_no.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.house_no&&ctx.formControl.house_no.valid&&(null!=ctx.formControl&&null!=ctx.formControl.house_no&&ctx.formControl.house_no.touched||null!=ctx.formControl&&null!=ctx.formControl.house_no&&ctx.formControl.house_no.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.house_no?null:ctx.formControl.house_no.invalid)&&((null==ctx.formControl||null==ctx.formControl.house_no?null:ctx.formControl.house_no.touched)||(null==ctx.formControl||null==ctx.formControl.house_no?null:ctx.formControl.house_no.dirty))),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",null!=ctx.formControl&&null!=ctx.formControl.country&&ctx.formControl.country.invalid&&(null!=ctx.formControl&&null!=ctx.formControl.country&&ctx.formControl.country.touched||null!=ctx.formControl&&null!=ctx.formControl.country&&ctx.formControl.country.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.country&&ctx.formControl.country.valid&&(null!=ctx.formControl&&null!=ctx.formControl.country&&ctx.formControl.country.touched||null!=ctx.formControl&&null!=ctx.formControl.country&&ctx.formControl.country.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngForOf\",ctx.countryInfo),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.country?null:ctx.formControl.country.invalid)&&((null==ctx.formControl||null==ctx.formControl.country?null:ctx.formControl.country.touched)||(null==ctx.formControl||null==ctx.formControl.country?null:ctx.formControl.country.dirty))),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",null!=ctx.formControl&&null!=ctx.formControl.state&&ctx.formControl.state.invalid&&(null!=ctx.formControl&&null!=ctx.formControl.state&&ctx.formControl.state.touched||null!=ctx.formControl&&null!=ctx.formControl.state&&ctx.formControl.state.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.state&&ctx.formControl.state.valid&&(null!=ctx.formControl&&null!=ctx.formControl.state&&ctx.formControl.state.touched||null!=ctx.formControl&&null!=ctx.formControl.state&&ctx.formControl.state.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"ngForOf\",ctx.stateInfo),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.state?null:ctx.formControl.state.invalid)&&((null==ctx.formControl||null==ctx.formControl.state?null:ctx.formControl.state.touched)||(null==ctx.formControl||null==ctx.formControl.state?null:ctx.formControl.state.dirty))),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",null!=ctx.formControl&&null!=ctx.formControl.city&&ctx.formControl.city.invalid&&(null!=ctx.formControl&&null!=ctx.formControl.city&&ctx.formControl.city.touched||null!=ctx.formControl&&null!=ctx.formControl.city&&ctx.formControl.city.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.city&&ctx.formControl.city.valid&&(null!=ctx.formControl&&null!=ctx.formControl.city&&ctx.formControl.city.touched||null!=ctx.formControl&&null!=ctx.formControl.city&&ctx.formControl.city.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"ngForOf\",ctx.cityInfo),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.city?null:ctx.formControl.city.invalid)&&((null==ctx.formControl||null==ctx.formControl.city?null:ctx.formControl.city.touched)||(null==ctx.formControl||null==ctx.formControl.city?null:ctx.formControl.city.dirty))),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",(null!=ctx.formControl&&null!=ctx.formControl.pincode&&null!=ctx.formControl.pincode.errors&&ctx.formControl.pincode.errors.required||null!=ctx.formControl&&null!=ctx.formControl.pincode&&null!=ctx.formControl.pincode.errors&&ctx.formControl.pincode.errors.pattern)&&(null!=ctx.formControl&&null!=ctx.formControl.pincode&&ctx.formControl.pincode.touched||null!=ctx.formControl&&null!=ctx.formControl.pincode&&ctx.formControl.pincode.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.pincode&&ctx.formControl.pincode.valid&&(null!=ctx.formControl&&null!=ctx.formControl.pincode&&ctx.formControl.pincode.touched||null!=ctx.formControl&&null!=ctx.formControl.pincode&&ctx.formControl.pincode.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",(null==ctx.formControl||null==ctx.formControl.pincode?null:ctx.formControl.pincode.invalid)&&((null==ctx.formControl||null==ctx.formControl.pincode?null:ctx.formControl.pincode.touched)||(null==ctx.formControl||null==ctx.formControl.pincode?null:ctx.formControl.pincode.dirty))),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"ngIf\",ctx.products.length>0))},directives:[ngx_spinner.a,fesm2015_router.f,common.NgForOf,common.NgStyle,fesm2015_forms.s,fesm2015_forms.j,fesm2015_forms.f,fesm2015_forms.p,fesm2015_forms.i,fesm2015_forms.d,fesm2015_forms.o,common.NgClass,fesm2015_forms.l,fesm2015_forms.r,common.NgIf,fesm2015_forms.a,text_only_directive.a,numonly_directive.a],styles:[\"\"]}),CartAddressComponent})();var tslib_es6=__webpack_require__(\"mrSG\"),environment_prod=__webpack_require__(\"cxbk\");class CardError{}const cart_payment_component_c0=[\"cardInfo\"];function CartPaymentComponent_div_36_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",34),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2,\"Total Price(AUD)\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](3,\"h3\"),core[\"ɵɵtext\"](4),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r0=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](4),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r0.total,\"\")}}function CartPaymentComponent_ng_template_37_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"div\",34),core[\"ɵɵelementStart\"](1,\"h3\"),core[\"ɵɵtext\"](2,\"Total Price(AUD)\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](3,\"h3\"),core[\"ɵɵtext\"](4),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r2=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](4),core[\"ɵɵtextInterpolate1\"](\"$\",ctx_r2.total-ctx_r2.dealerDiscountAmount,\"\")}}function CartPaymentComponent_p_53_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",35),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r3=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\" \",ctx_r3.cardNumberError,\" \")}}function CartPaymentComponent_p_61_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",35),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r4=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\" \",ctx_r4.cardMonthError,\" \")}}function CartPaymentComponent_p_68_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",35),core[\"ɵɵtext\"](1),core[\"ɵɵelementEnd\"]()),2&rf){const ctx_r5=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](1),core[\"ɵɵtextInterpolate1\"](\" \",ctx_r5.cardCvvError,\" \")}}function CartPaymentComponent_p_75_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"p\",36),core[\"ɵɵtext\"](1,\" Name should be of minimum 5 characters \"),core[\"ɵɵelementEnd\"]())}function CartPaymentComponent_button_76_Template(rf,ctx){if(1&rf){const _r10=core[\"ɵɵgetCurrentView\"]();core[\"ɵɵelementStart\"](0,\"button\"),core[\"ɵɵelementStart\"](1,\"a\",37),core[\"ɵɵlistener\"](\"click\",(function(){core[\"ɵɵrestoreView\"](_r10);const ctx_r9=core[\"ɵɵnextContext\"]();return ctx_r9.submitPaymentForm(ctx_r9.paymentForm)})),core[\"ɵɵtext\"](2),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()}if(2&rf){const ctx_r7=core[\"ɵɵnextContext\"]();core[\"ɵɵadvance\"](2),core[\"ɵɵtextInterpolate1\"](\"Pay $\",ctx_r7.total,\"\")}}function CartPaymentComponent_button_77_Template(rf,ctx){1&rf&&(core[\"ɵɵelementStart\"](0,\"button\"),core[\"ɵɵelementStart\"](1,\"a\",20),core[\"ɵɵelement\"](2,\"span\",38),core[\"ɵɵtext\"](3,\"Payment Processing \"),core[\"ɵɵelement\"](4,\"i\",39),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]())}const cart_payment_component_c1=function(){return[\"/home\"]},cart_payment_component_c2=function(){return[\"/cart\"]};let cart_payment_component_CartPaymentComponent=(()=>{class CartPaymentComponent{constructor(fb,apiService,router,toastr,ngZone,activatedRoute,zone,spinner){this.fb=fb,this.apiService=apiService,this.router=router,this.toastr=toastr,this.ngZone=ngZone,this.activatedRoute=activatedRoute,this.zone=zone,this.spinner=spinner,this.paymentLoading=!1,this.cardErrors=new CardError,this.cardHandler=this.onChange.bind(this),this.subscribe=[],this.total=0,this.toggleCanDeactivate=!0,this.countryList=[],this.products=[],this.toggleCardNumberError=!1,this.toggleCardMonthError=!1,this.toggleCardCvvError=!1,this.dealerDiscountAmount=0,this.applyDealerDiscount=!1}ngOnInit(){if(this.subscribe.push(this.activatedRoute.params.subscribe(res=>{res.id1&&(this.addressId=res.id1,this.buyNowCartId=res.id2,this.getAddress(res.id1))})),\"Dealer\"===window.atob(sessionStorage.getItem(\"userType\"))&&\"D\"===window.atob(sessionStorage.getItem(\"userStatus\")))if(this.applyDealerDiscount=!0,null===window.atob(sessionStorage.getItem(\"userDiscount\")))this.apiService.dealerDiscount().subscribe(res=>{!0===res.return&&(this.dealerDiscountPercentage=res.dealer_discount,this.dealerDiscountPercentage=.01*this.dealerDiscountPercentage)});else{let userDiscount=window.atob(sessionStorage.getItem(\"userDiscount\"));this.dealerDiscountPercentage=.01*+userDiscount}this.subscribe.push(0===this.buyNowCartId.length?this.apiService.getCartById(window.atob(sessionStorage.getItem(\"cartId\"))).subscribe(res=>{200===res.code&&(this.products=JSON.parse(res.details.cart),this.findGrandTotal())},err=>{var _a;this.toastr.error((null===(_a=null==err?void 0:err.error)||void 0===_a?void 0:_a.message)||(null==err?void 0:err.message))}):this.apiService.getCartById(this.buyNowCartId).subscribe(res=>{200===res.code&&(this.products=JSON.parse(res.details.cart),this.findGrandTotal())},err=>{var _a;this.toastr.error((null===(_a=null==err?void 0:err.error)||void 0===_a?void 0:_a.message)||(null==err?void 0:err.message))})),this.subscribe.push(this.apiService.getCountryData().subscribe(res=>{res&&(this.countryList=res.countries)})),this.createPaymentForm()}ngAfterViewInit(){this.spinner.show();const cardStyle={base:{iconColor:\"#1586ad\",color:\"#32325d\",fontFamily:'\"Helvetica Neue\", Helvetica, sans-serif',fontSmoothing:\"antialiased\",fontSize:\"20px\",\"::placeholder\":{color:\"rgba(190, 193, 197, 0.9)\",fontSize:\"0.9em\",fontFamily:'\"Trebuchet MS\", \"Lucida Sans Unicode\", \"Lucida Grande\", \"Lucida Sans\", Arial, sans-serif'}},invalid:{color:\"red\",iconColor:\"#fa755a\"}};this.stripe=Stripe(environment_prod.a.stripeTestKey);const elements=this.stripe.elements();this.cardNumber=elements.create(\"cardNumber\",{showIcon:!0,placeholder:\"Enter your card number\",style:cardStyle}),this.cardNumber.mount(\"#cc-number\"),this.cardNumber.on(\"change\",error=>{(void 0===error.error||error)&&(void 0!==error.error?(this.toggleCardNumberError=!0,this.cardNumberError=error.error.message):this.toggleCardNumberError=!1)}),this.cardExpiry=elements.create(\"cardExpiry\",{placeholder:\"MM / YY\",style:cardStyle}),this.cardExpiry.mount(\"#cc-exp-date\"),this.cardExpiry.on(\"change\",error=>{(void 0===error.error||error)&&(void 0!==error.error?(this.toggleCardMonthError=!0,this.cardMonthError=error.error.message):this.toggleCardMonthError=!1)}),this.cardCvc=elements.create(\"cardCvc\",{placeholder:\"Enter CVC\",style:cardStyle}),this.cardCvc.mount(\"#cc-cvc\"),this.cardCvc.on(\"change\",error=>{(void 0===error.error||error)&&(void 0!==error.error?(this.toggleCardCvvError=!0,this.cardCvvError=error.error.message):this.toggleCardCvvError=!1)}),this.spinner.hide()}findGrandTotal(){let price,gstPrice,subPrice=0,shippingCharges=0,productPrice=0;this.products.forEach(ele=>{ele.productQuantity&&(productPrice=(ele.discountPrice>0?ele.discountPrice:ele.price)*ele.productQuantity+productPrice)}),price=productPrice,shippingCharges=.05*price,subPrice=price+shippingCharges,gstPrice=.1*subPrice,this.total=Math.round(gstPrice+subPrice),this.dealerDiscountAmount=Math.round(this.dealerDiscountPercentage*this.total)}getAddress(addressId){this.subscribe.push(this.apiService.getAddressById(addressId).subscribe(res=>{res.address.length>0&&(this.addressDetails=res.address[0])}))}loadStripe(){if(!window.document.getElementById(\"stripe-custom-form-script\")){const s=window.document.createElement(\"script\");s.id=\"stripe-custom-form-script\",s.type=\"text/javascript\",s.src=\"https://js.stripe.com/v2/\",s.onload=()=>{window.Stripe.setPublishableKey(environment_prod.a.stripeTestKey)},window.document.body.appendChild(s)}}createPaymentForm(){this.paymentForm=this.fb.group({cardUserName:new fesm2015_forms.c(\"\",[fesm2015_forms.q.minLength(5),fesm2015_forms.q.required])})}get formControl(){return this.paymentForm.controls}validateAllFields(formGroup){Object.keys(this.formControl).forEach(field=>{const control=formGroup.get(field);control instanceof fesm2015_forms.c?control.markAsTouched({onlySelf:!0}):control instanceof fesm2015_forms.e&&this.validateAllFields(control)})}onChange({error:error}){this.cardErrors=error||null}submitPaymentForm(form){var _a,_b,_c,_d,_e;return Object(tslib_es6.a)(this,void 0,void 0,(function*(){if(form.invalid)this.validateAllFields(form);else{this.paymentLoading=!0,this.toggleCanDeactivate=!1;const{token:token,error:error}=yield this.stripe.createToken(this.cardNumber,{name:form.value.cardUserName,address_city:null===(_a=this.addressDetails)||void 0===_a?void 0:_a.city,address_country:null===(_b=this.addressDetails)||void 0===_b?void 0:_b.country,address_line1:null===(_c=this.addressDetails)||void 0===_c?void 0:_c.house_no,address_state:null===(_d=this.addressDetails)||void 0===_d?void 0:_d.state,address_zip:null===(_e=this.addressDetails)||void 0===_e?void 0:_e.pincode});token?this.onSuccess(token):(this.spinner.hide(\"sp3\"),this.onError(error))}}))}onSuccess(token){this.paymentLoading=!1;const paymentData={token:token.id,amount:Math.round(this.total)};this.subscribe.push(this.apiService.payment(paymentData).subscribe(res=>{200===res.code&&this.createOrder(paymentData.token)},err=>{var _a;this.paymentLoading=!1,this.toastr.error((null===(_a=null==err?void 0:err.error)||void 0===_a?void 0:_a.message)||(null==err?void 0:err.message))}))}onError(error){this.paymentLoading=!1,error.message&&this.toastr.error(error.message)}createOrder(token){const additionalDetails=JSON.parse(window.atob(sessionStorage.getItem(\"additionalPaymentDetails\"))),orderData=Object.assign({address_id:this.addressId,user_id:+window.atob(sessionStorage.getItem(\"id\")),amount:this.total.toString(),transaction_id:token,purchase_details:this.products,cart_id:+window.atob(sessionStorage.getItem(\"cartId\"))},additionalDetails);this.subscribe.push(this.apiService.addOrders(orderData).subscribe(res=>{200===res.code&&(this.orderId=res.details.id,sessionStorage.removeItem(\"buyNow\"),this.apiService.totalItemsInCart(),this.router.navigate([\"/payment-successful\"],{queryParams:{orderId:this.orderId}}))},err=>{var _a;this.toastr.error((null===(_a=null==err?void 0:err.error)||void 0===_a?void 0:_a.message)||(null==err?void 0:err.message))}))}updateCart(){const updateCart={id:window.atob(sessionStorage.getItem(\"cartId\")),user_id:window.atob(sessionStorage.getItem(\"id\")),cart:\"[]\"};console.log(\"update\",updateCart)}canDeactivate(){if(this.toggleCanDeactivate){if(sessionStorage.getItem(\"cartId\")){if(sessionStorage.getItem(\"buyNow\")){const cartLocalData=JSON.parse(window.atob(sessionStorage.getItem(\"buyNow\"))),accessoriesToAdd=[],sparesToAdd=[];let cart;return null!==cartLocalData&&cartLocalData.forEach(cartData=>{\"product\"===cartData.type?cart=new cart_details.a(cartData.productId,cartData.code,cartData.description,cartData.price,cartData.discountPrice,cartData.type,cartData.pole,cartData.flow,cartData.head,cartData.speed,cartData.power,cartData.engineSpeed,cartData.enginekW,cartData.driveType,cartData.productQuantity):\"accessory\"===cartData.type?accessoriesToAdd.push(cartData):\"spare\"===cartData.type&&sparesToAdd.push(cartData)}),new Promise(resolve=>{this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem(\"cartId\"))).subscribe(res=>{if(200===res.code){let cartDetails=[];if(cartDetails=JSON.parse(res.details.cart),cartDetails.length<=0)cartDetails.push(Object.assign({},cart)),cartDetails.push(...accessoriesToAdd),cartDetails.push(...sparesToAdd);else{const cartAccessoryDataSet=new Array,cartSpareDataSet=new Array;let cartProductDataSet={},spareNotExist=!0,accessoryNotExist=!0,cartNotExist=!0;console.log(cart,\"cart\"),console.log(cartDetails,\"cart1\");for(let i=0;i<cartDetails.length;i++)if(\"product\"===cartDetails[i].type)cartNotExist=!1,(\"\"===cartDetails[i].driveType||cartDetails[i].driveType)===(\"\"===cart.driveType||cart.driveType)&&cartDetails[i].code===cart.code&&cartDetails[i].pole===cart.pole?cartDetails[i].productQuantity++:cartProductDataSet=cart;else if(\"accessory\"===cartDetails[i].type){accessoryNotExist=!1;for(let j=0;j<accessoriesToAdd.length;j++)accessoriesToAdd[j].description===cartDetails[i].description&&accessoriesToAdd[j].pole===cartDetails[i].pole&&accessoriesToAdd[j].driveType===cartDetails[i].driveType?cartDetails[i].productQuantity++:cartDetails.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.some(res=>res.description===accessoriesToAdd[j].description&&res.pole===accessoriesToAdd[j].pole&&res.driveType===accessoriesToAdd[j].driveType)||cartAccessoryDataSet.push(accessoriesToAdd[j])}else if(\"spare\"===cartDetails[i].type){spareNotExist=!1;for(let j=0;j<sparesToAdd.length;j++)sparesToAdd[j].description===cartDetails[i].description&&sparesToAdd[j].pole===cartDetails[i].pole&&sparesToAdd[j].driveType===cartDetails[i].driveType?cartDetails[i].productQuantity++:cartDetails.some(res=>res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===sparesToAdd[j].driveType)||cartSpareDataSet.some(res=>res.description===sparesToAdd[j].description&&res.pole===sparesToAdd[j].pole&&res.driveType===sparesToAdd[j].driveType)||cartSpareDataSet.push(sparesToAdd[j])}cartAccessoryDataSet.length>0&&cartDetails.push(...cartAccessoryDataSet),cartSpareDataSet.length>0&&cartDetails.push(...cartSpareDataSet),Object.keys(cartProductDataSet).length>0&&cartDetails.push(Object.assign({},cartProductDataSet)),accessoryNotExist&&cartDetails.push(...accessoriesToAdd),spareNotExist&&cartDetails.push(...sparesToAdd),cartNotExist&&cartDetails.push(...cart)}const updateCart={id:window.atob(sessionStorage.getItem(\"cartId\")),user_id:window.atob(sessionStorage.getItem(\"id\")),cart:JSON.stringify(cartDetails)};return this.subscribe.push(this.apiService.updateCart(updateCart).subscribe(response=>{if(200===response.code)return sessionStorage.removeItem(\"buyNow\"),this.apiService.totalItemsInCart(),resolve(!0)}))}}))})}return!0}return sessionStorage.setItem(\"cartId\",window.btoa(this.buyNowCartId)),this.apiService.totalItemsInCart(),sessionStorage.removeItem(\"buyNow\"),!0}return!0}ngOnDestroy(){this.subscribe.forEach(s=>{s&&s.unsubscribe()}),this.cardNumber.destroy(),this.cardExpiry.destroy(),this.cardCvc.destroy()}}return CartPaymentComponent.ɵfac=function(t){return new(t||CartPaymentComponent)(core[\"ɵɵdirectiveInject\"](fesm2015_forms.b),core[\"ɵɵdirectiveInject\"](api_service.a),core[\"ɵɵdirectiveInject\"](fesm2015_router.c),core[\"ɵɵdirectiveInject\"](ngx_toastr.b),core[\"ɵɵdirectiveInject\"](core.NgZone),core[\"ɵɵdirectiveInject\"](fesm2015_router.a),core[\"ɵɵdirectiveInject\"](core.NgZone),core[\"ɵɵdirectiveInject\"](ngx_spinner.c))},CartPaymentComponent.ɵcmp=core[\"ɵɵdefineComponent\"]({type:CartPaymentComponent,selectors:[[\"app-cart-payment\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core[\"ɵɵstaticViewQuery\"](cart_payment_component_c0,!0),2&rf&&core[\"ɵɵqueryRefresh\"](_t=core[\"ɵɵloadQuery\"]())&&(ctx.cardElement=_t.first)},decls:78,vars:18,consts:[[\"bdColor\",\"rgb(0,0,0)\",\"size\",\"medium\",\"color\",\"#2e94ef\",\"type\",\"ball-newton-cradle\",3,\"fullScreen\"],[2,\"color\",\"white\"],[1,\"main-container\",\"cartpage\",\"addresspage\",\"paymentpage\"],[1,\"breadcrum\"],[1,\"container\"],[\"href\",\"javascript:void(0)\",3,\"routerLink\"],[1,\"cart-scale\"],[1,\"cart-scale-inner\"],[1,\"scale-no\",\"active-scale\"],[2,\"pointer-events\",\"none\"],[1,\"scale-no\"],[1,\"cart-section\"],[1,\"cart-inner\"],[1,\"price-detail\"],[1,\"price-row\",\"total-price\",2,\"border-top\",\"none\"],[\"class\",\"left-price-spare\",4,\"ngIf\",\"ngIfElse\"],[\"elsePart\",\"\"],[1,\"left-price-spare\",\"coupon-field\"],[\"type\",\"text\",\"placeholder\",\"Coupon Code\"],[1,\"coupon-btn\"],[\"href\",\"javascript:void(0)\"],[1,\"cart\"],[1,\"address-row\",\"full-address-row\"],[3,\"formGroup\"],[1,\"address-feild\"],[\"id\",\"cc-number\",3,\"ngClass\"],[\"style\",\"color: red !important\",4,\"ngIf\"],[1,\"address-feild\",\"half-field\"],[2,\"width\",\"50%\"],[\"id\",\"cc-exp-date\",3,\"ngClass\"],[\"id\",\"cc-cvc\",3,\"ngClass\"],[\"type\",\"text\",\"formControlName\",\"cardUserName\",\"placeholder\",\"Navodita Aggarwal\",\"required\",\"\",3,\"ngClass\"],[\"style\",\"color: red\",4,\"ngIf\"],[4,\"ngIf\"],[1,\"left-price-spare\"],[2,\"color\",\"red !important\"],[2,\"color\",\"red\"],[\"href\",\"javascript:void(0)\",3,\"click\"],[\"role\",\"status\",\"aria-hidden\",\"true\",1,\"spinner-border\",\"spinner-border-sm\"],[1,\"fas\",\"fa-spinner\",\"fa-spin\"]],template:function(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"ngx-spinner\",0),core[\"ɵɵelementStart\"](1,\"p\",1),core[\"ɵɵtext\"](2,\"Loading...\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](3,\"div\",2),core[\"ɵɵelementStart\"](4,\"div\",3),core[\"ɵɵelementStart\"](5,\"div\",4),core[\"ɵɵelementStart\"](6,\"p\"),core[\"ɵɵelementStart\"](7,\"a\",5),core[\"ɵɵtext\"](8,\"Home\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtext\"](9,\" / \"),core[\"ɵɵelementStart\"](10,\"a\",5),core[\"ɵɵtext\"](11,\"Cart\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵtext\"](12,\" / Payment \"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](13,\"div\",6),core[\"ɵɵelementStart\"](14,\"div\",4),core[\"ɵɵelementStart\"](15,\"div\",7),core[\"ɵɵelementStart\"](16,\"div\",8),core[\"ɵɵelementStart\"](17,\"a\",9),core[\"ɵɵtext\"](18,\"1\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](19,\"small\"),core[\"ɵɵtext\"](20,\"Cart\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](21,\"div\",10),core[\"ɵɵelementStart\"](22,\"a\",9),core[\"ɵɵtext\"](23,\"2\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](24,\"small\"),core[\"ɵɵtext\"](25,\"Address\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](26,\"div\",10),core[\"ɵɵelementStart\"](27,\"a\",9),core[\"ɵɵtext\"](28,\"3\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](29,\"small\"),core[\"ɵɵtext\"](30,\"Payment\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](31,\"div\",11),core[\"ɵɵelementStart\"](32,\"div\",4),core[\"ɵɵelementStart\"](33,\"div\",12),core[\"ɵɵelementStart\"](34,\"div\",13),core[\"ɵɵelementStart\"](35,\"div\",14),core[\"ɵɵtemplate\"](36,CartPaymentComponent_div_36_Template,5,1,\"div\",15),core[\"ɵɵtemplate\"](37,CartPaymentComponent_ng_template_37_Template,5,1,\"ng-template\",null,16,core[\"ɵɵtemplateRefExtractor\"]),core[\"ɵɵelementStart\"](39,\"div\",17),core[\"ɵɵelement\"](40,\"input\",18),core[\"ɵɵelementStart\"](41,\"button\",19),core[\"ɵɵelementStart\"](42,\"a\",20),core[\"ɵɵtext\"](43,\"Apply Coupon\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](44,\"div\",21),core[\"ɵɵelementStart\"](45,\"div\",22),core[\"ɵɵelementStart\"](46,\"form\",23),core[\"ɵɵelementStart\"](47,\"div\",24),core[\"ɵɵelementStart\"](48,\"label\"),core[\"ɵɵtext\"](49,\"Card Information \"),core[\"ɵɵelementStart\"](50,\"span\"),core[\"ɵɵtext\"](51,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](52,\"div\",25),core[\"ɵɵtemplate\"](53,CartPaymentComponent_p_53_Template,2,1,\"p\",26),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](54,\"div\",27),core[\"ɵɵelementStart\"](55,\"div\",28),core[\"ɵɵelementStart\"](56,\"label\"),core[\"ɵɵtext\"](57,\"Exp. Month & Year \"),core[\"ɵɵelementStart\"](58,\"span\"),core[\"ɵɵtext\"](59,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](60,\"div\",29),core[\"ɵɵtemplate\"](61,CartPaymentComponent_p_61_Template,2,1,\"p\",26),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](62,\"div\",28),core[\"ɵɵelementStart\"](63,\"label\"),core[\"ɵɵtext\"](64,\" CVV \"),core[\"ɵɵelementStart\"](65,\"span\"),core[\"ɵɵtext\"](66,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](67,\"div\",30),core[\"ɵɵtemplate\"](68,CartPaymentComponent_p_68_Template,2,1,\"p\",26),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](69,\"div\",24),core[\"ɵɵelementStart\"](70,\"label\"),core[\"ɵɵtext\"](71,\"Name on Card \"),core[\"ɵɵelementStart\"](72,\"span\"),core[\"ɵɵtext\"](73,\"*\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelement\"](74,\"input\",31),core[\"ɵɵtemplate\"](75,CartPaymentComponent_p_75_Template,2,0,\"p\",32),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](76,CartPaymentComponent_button_76_Template,3,1,\"button\",33),core[\"ɵɵtemplate\"](77,CartPaymentComponent_button_77_Template,5,0,\"button\",33),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const _r1=core[\"ɵɵreference\"](38);core[\"ɵɵproperty\"](\"fullScreen\",!0),core[\"ɵɵadvance\"](7),core[\"ɵɵproperty\"](\"routerLink\",core[\"ɵɵpureFunction0\"](16,cart_payment_component_c1)),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"routerLink\",core[\"ɵɵpureFunction0\"](17,cart_payment_component_c2)),core[\"ɵɵadvance\"](26),core[\"ɵɵproperty\"](\"ngIf\",!ctx.applyDealerDiscount)(\"ngIfElse\",_r1),core[\"ɵɵadvance\"](10),core[\"ɵɵproperty\"](\"formGroup\",ctx.paymentForm),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",ctx.toggleCardNumberError?\"cardErr\":\"address-feildCard\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx.toggleCardNumberError),core[\"ɵɵadvance\"](7),core[\"ɵɵproperty\"](\"ngClass\",ctx.toggleCardMonthError?\"cardErr\":\"address-feildCard\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx.toggleCardMonthError),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",ctx.toggleCardCvvError?\"cardErr\":\"address-feildCard\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx.toggleCardCvvError),core[\"ɵɵadvance\"](6),core[\"ɵɵproperty\"](\"ngClass\",(null!=ctx.formControl&&null!=ctx.formControl.cardUserName&&null!=ctx.formControl.cardUserName.errors&&ctx.formControl.cardUserName.errors.minlength||null!=ctx.formControl&&null!=ctx.formControl.cardUserName&&null!=ctx.formControl.cardUserName.errors&&ctx.formControl.cardUserName.errors.required)&&(null!=ctx.formControl&&null!=ctx.formControl.cardUserName&&ctx.formControl.cardUserName.touched||null!=ctx.formControl&&null!=ctx.formControl.cardUserName&&ctx.formControl.cardUserName.dirty)?\"red\":null!=ctx.formControl&&null!=ctx.formControl.cardUserName&&ctx.formControl.cardUserName.valid&&(null!=ctx.formControl&&null!=ctx.formControl.cardUserName&&ctx.formControl.cardUserName.touched||null!=ctx.formControl&&null!=ctx.formControl.cardUserName&&ctx.formControl.cardUserName.dirty)?\"green\":\"\"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",((null==ctx.formControl||null==ctx.formControl.cardUserName||null==ctx.formControl.cardUserName.errors?null:ctx.formControl.cardUserName.errors.minlength)||(null==ctx.formControl||null==ctx.formControl.cardUserName||null==ctx.formControl.cardUserName.errors?null:ctx.formControl.cardUserName.errors.required))&&((null==ctx.formControl||null==ctx.formControl.cardUserName?null:ctx.formControl.cardUserName.touched)||(null==ctx.formControl||null==ctx.formControl.cardUserName?null:ctx.formControl.cardUserName.dirty))),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",!ctx.paymentLoading),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngIf\",ctx.paymentLoading)}},directives:[ngx_spinner.a,fesm2015_router.f,common.NgIf,fesm2015_forms.s,fesm2015_forms.j,fesm2015_forms.f,common.NgClass,fesm2015_forms.a,fesm2015_forms.i,fesm2015_forms.d,fesm2015_forms.o],styles:[\"#card-info[_ngcontent-%COMP%]{width:100%;font-size:14px;font-weight:400;height:48px;padding:10px;border:none;border-radius:2px;background:rgba(0,0,0,.05);-moz-appearance:none;appearance:none;-webkit-appearance:none}.cardErr[_ngcontent-%COMP%]{border:1px solid red!important}\"]}),CartPaymentComponent})();var map=__webpack_require__(\"lJxs\");let cart_resolver_service_CartResolverService=(()=>{class CartResolverService{constructor(apiService){this.apiService=apiService}resolve(route,state){if(sessionStorage.getItem(\"cartId\"))return this.apiService.getCartById(window.atob(sessionStorage.getItem(\"cartId\"))).pipe(Object(map.a)(data=>200==+data.code?JSON.parse(data.details.cart):[]))}}return CartResolverService.ɵfac=function(t){return new(t||CartResolverService)(core[\"ɵɵinject\"](api_service.a))},CartResolverService.ɵprov=core[\"ɵɵdefineInjectable\"]({token:CartResolverService,factory:CartResolverService.ɵfac,providedIn:\"root\"}),CartResolverService})(),deactive_guard_guard_DeactiveGuard=(()=>{class DeactiveGuard{canDeactivate(component,currentRoute,currentState,nextState){return component.canDeactivate()}}return DeactiveGuard.ɵfac=function(t){return new(t||DeactiveGuard)},DeactiveGuard.ɵprov=core[\"ɵɵdefineInjectable\"]({token:DeactiveGuard,factory:DeactiveGuard.ɵfac,providedIn:\"root\"}),DeactiveGuard})();const routes=[{path:\"\",component:cart_details_component_CartDetailsComponent,resolve:{cartData:cart_resolver_service_CartResolverService}},{path:\"deliveryAddress\",component:cart_address_component_CartAddressComponent,canActivate:[route_guard_guard_RouteGuard],canDeactivate:[deactive_guard_guard_DeactiveGuard]},{path:\"payment/:id1/:id2\",component:cart_payment_component_CartPaymentComponent,canActivate:[route_guard_guard_RouteGuard],canDeactivate:[deactive_guard_guard_DeactiveGuard]}];let cart_routing_module_CartRoutingModule=(()=>{class CartRoutingModule{}return CartRoutingModule.ɵmod=core[\"ɵɵdefineNgModule\"]({type:CartRoutingModule}),CartRoutingModule.ɵinj=core[\"ɵɵdefineInjector\"]({factory:function(t){return new(t||CartRoutingModule)},imports:[[fesm2015_router.g.forChild(routes)],fesm2015_router.g]}),CartRoutingModule})();var directives_module=__webpack_require__(\"FUS3\");__webpack_require__(\"2Vo4\");let angular_cc_library_CreditCardDirectivesModule=(()=>{let CreditCardDirectivesModule=class{};return CreditCardDirectivesModule.ɵmod=core[\"ɵɵdefineNgModule\"]({type:CreditCardDirectivesModule}),CreditCardDirectivesModule.ɵinj=core[\"ɵɵdefineInjector\"]({factory:function(t){return new(t||CreditCardDirectivesModule)}}),CreditCardDirectivesModule})(),cart_module_CartModule=(()=>{class CartModule{}return CartModule.ɵmod=core[\"ɵɵdefineNgModule\"]({type:CartModule}),CartModule.ɵinj=core[\"ɵɵdefineInjector\"]({factory:function(t){return new(t||CartModule)},providers:[route_guard_guard_RouteGuard,deactive_guard_guard_DeactiveGuard],imports:[[common.CommonModule,fesm2015_forms.g,fesm2015_forms.n,cart_routing_module_CartRoutingModule,directives_module.a,angular_cc_library_CreditCardDirectivesModule,ngx_toastr.a,ngx_spinner.b]]}),CartModule})()}}]);","extractedComments":[]}