(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"e/Ek":function(e,t,n){"use strict";n.r(t),n.d(t,"CartModule",(function(){return ke}));var r=n("ofXK"),o=n("3Pt+"),l=n("fXoL"),a=n("5eHb"),i=n("tyNb");let s=(()=>{class e{constructor(e,t){this.toaster=e,this.router=t}canActivate(e,t){if(sessionStorage.getItem("id"))return!0;this.toaster.success("Please sign-in to continue"),this.router.navigate(["/sign-in"])}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](a.b),l["\u0275\u0275inject"](i.c))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();var d=n("1UKJ"),c=n("H+bZ"),m=n("3iOn");const u=["input"];function p(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p"),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",null==e?null:e.description,"")}}function g(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p"),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](null==e?null:e.driveType)}}function f(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",29),l["\u0275\u0275elementStart"](1,"div",30),l["\u0275\u0275elementStart"](2,"div",31),l["\u0275\u0275element"](3,"img",32),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"div",33),l["\u0275\u0275elementStart"](5,"span"),l["\u0275\u0275elementStart"](6,"strong"),l["\u0275\u0275text"](7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](8,p,2,1,"p",4),l["\u0275\u0275template"](9,g,2,1,"p",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",34),l["\u0275\u0275elementStart"](11,"div",35),l["\u0275\u0275elementStart"](12,"span",36),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const n=t.index;return l["\u0275\u0275nextContext"](2).decrementProductQuantity(n)})),l["\u0275\u0275text"](13,"-"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](14,"input",37),l["\u0275\u0275elementStart"](15,"span",38),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const n=t.index;return l["\u0275\u0275nextContext"](2).incrementProductQuantity(n)})),l["\u0275\u0275text"](16,"+"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"h3"),l["\u0275\u0275text"](18),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("src",e.img,l["\u0275\u0275sanitizeUrl"]),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](null==e?null:e.code),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",""!==(null==e?null:e.description)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",""!==(null==e?null:e.driveType)),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("value",null==e?null:e.productQuantity),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"]("$ ",(null==e?null:e.discountPrice)>0?null==e?null:e.discountPrice:null==e?null:e.price,"")}}function h(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p"),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("(",null==e?null:e.driveType,")")}}function v(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",43),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](3,h,2,1,"p",4),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](null==e?null:e.description),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",""!==(null==e?null:e.driveType))}}function C(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p"),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("(",null==e?null:e.description,")")}}function y(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",43),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](3,C,2,1,"p",4),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](null==e?null:e.code),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",""!==(null==e?null:e.description))}}function S(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",39),l["\u0275\u0275template"](1,v,4,2,"div",40),l["\u0275\u0275template"](2,y,4,2,"ng-template",null,41,l["\u0275\u0275templateRefExtractor"]),l["\u0275\u0275elementStart"](4,"div",42),l["\u0275\u0275elementStart"](5,"h3"),l["\u0275\u0275text"](6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=l["\u0275\u0275reference"](3);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf","spare"!==(null==e?null:e.type))("ngIfElse",n),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"]("$ ",(null==e?null:e.productQuantity)*((null==e?null:e.discountPrice)>0?null==e?null:e.discountPrice:null==e?null:e.price),"")}}function I(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",26),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2,"Dealer Discount (10%) "),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275text"](4," (In AUD)"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"h3"),l["\u0275\u0275text"](6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](6),l["\u0275\u0275textInterpolate1"]("$",e.finalPrice+e.gstPrice-e.dealerDiscountAmount,"")}}function E(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",44),l["\u0275\u0275elementStart"](1,"button"),l["\u0275\u0275elementStart"](2,"a",45),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"](2).onContinue("sign-in")})),l["\u0275\u0275text"](3,"Continue "),l["\u0275\u0275elementStart"](4,"span",46),l["\u0275\u0275text"](5,"Click here to sign-in"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}}function b(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275elementStart"](1,"button"),l["\u0275\u0275elementStart"](2,"a",47),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"](2).onContinue("continue")})),l["\u0275\u0275text"](3,"Continue"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementContainerEnd"]()}}function x(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275elementStart"](1,"div",13),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"div",14),l["\u0275\u0275elementStart"](4,"div",15),l["\u0275\u0275elementStart"](5,"a",16),l["\u0275\u0275text"](6,"1"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"small"),l["\u0275\u0275text"](8,"Cart"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div",17),l["\u0275\u0275elementStart"](10,"a",16),l["\u0275\u0275text"](11,"2"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"small"),l["\u0275\u0275text"](13,"Address"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](14,"div",17),l["\u0275\u0275elementStart"](15,"a",16),l["\u0275\u0275text"](16,"3"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"small"),l["\u0275\u0275text"](18,"Payment"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](19,"div",18),l["\u0275\u0275elementStart"](20,"div",2),l["\u0275\u0275elementStart"](21,"div",19),l["\u0275\u0275elementStart"](22,"div",20),l["\u0275\u0275elementStart"](23,"h3",21),l["\u0275\u0275text"](24,"Cart"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](25,f,19,6,"div",22),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](26,"div",23),l["\u0275\u0275elementStart"](27,"h3",21),l["\u0275\u0275text"](28,"Price Detail"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](29,S,7,3,"div",24),l["\u0275\u0275elementStart"](30,"div"),l["\u0275\u0275elementStart"](31,"div",25),l["\u0275\u0275elementStart"](32,"div",26),l["\u0275\u0275elementStart"](33,"h3"),l["\u0275\u0275text"](34,"Sub Total"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](35,"h3"),l["\u0275\u0275text"](36),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](37,"div",26),l["\u0275\u0275elementStart"](38,"h3"),l["\u0275\u0275text"](39,"Shipping & Handling"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](40,"h3"),l["\u0275\u0275text"](41),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](42,"div",26),l["\u0275\u0275elementStart"](43,"h3"),l["\u0275\u0275text"](44,"Total (including GST@10%) "),l["\u0275\u0275element"](45,"br"),l["\u0275\u0275text"](46," (In AUD)"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](47,"h3"),l["\u0275\u0275text"](48),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](49,I,7,1,"div",27),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](50,E,6,0,"div",28),l["\u0275\u0275template"](51,b,4,0,"ng-container",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementContainerEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](25),l["\u0275\u0275property"]("ngForOf",e.products),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngForOf",e.products),l["\u0275\u0275advance"](7),l["\u0275\u0275textInterpolate1"]("$",e.grandTotal,""),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"]("$",e.shippingCharges,""),l["\u0275\u0275advance"](7),l["\u0275\u0275textInterpolate1"]("$",e.finalPrice+e.gstPrice,""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.applyDealerDiscount),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!e.toggleBtn),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.toggleBtn)}}function w(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"p",51),l["\u0275\u0275text"](1,"Your cart is currently empty. Please "),l["\u0275\u0275elementStart"](2,"a",52),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"](2).redirect("sign-in")})),l["\u0275\u0275text"](3,"Sign-in"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](4," or "),l["\u0275\u0275elementStart"](5,"a",52),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"](2).redirect("sign-up")})),l["\u0275\u0275text"](6,"Sign-up"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](7," here."),l["\u0275\u0275elementEnd"]()}}function N(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",51),l["\u0275\u0275text"](1,"Your cart is currently empty. Please select a pump or spare part to purchase."),l["\u0275\u0275elementEnd"]())}function P(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275elementStart"](1,"div",48),l["\u0275\u0275element"](2,"img",49),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](3,w,8,0,"p",50),l["\u0275\u0275template"](4,N,2,0,"p",50),l["\u0275\u0275elementContainerEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!e.toggleBtn),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.toggleBtn)}}function T(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",53),l["\u0275\u0275text"](1,"If you remove this, then accessories related to this will be removed and spares will be charged as per original price."),l["\u0275\u0275elementEnd"]())}const A=function(){return["/home"]};let _=(()=>{class e{constructor(e,t,n){this.apiService=e,this.router=t,this.activatedRoute=n,this.subscribe=[],this.grandTotal=0,this.shippingCharges=0,this.finalPrice=0,this.productQuantity=0,this.products=[],this.toggleBtn=!1,this.showDeleteMsg=!1,this.applyDealerDiscount=!1,this.dealerDiscountAmount=0}ngOnInit(){if(sessionStorage.getItem("id")){if(this.toggleBtn=!0,sessionStorage.getItem("cartId")){if("Dealer"===window.atob(sessionStorage.getItem("userType"))&&"D"===window.atob(sessionStorage.getItem("userStatus")))if(this.applyDealerDiscount=!0,null===window.atob(sessionStorage.getItem("userDiscount")))this.apiService.dealerDiscount().subscribe(e=>{!0===e.return&&(this.dealerDiscountPercentage=e.data[0].discount_rate,this.dealerDiscountPercentage=.01*this.dealerDiscountPercentage)});else{let e=window.atob(sessionStorage.getItem("userDiscount"));this.dealerDiscountPercentage=.01*+e}sessionStorage.getItem("cart")?this.updateCartDetails(window.atob(sessionStorage.getItem("cart")),"session"):this.subscribe.push(this.activatedRoute.data.subscribe(e=>{this.products=e.cartData,this.insertImages(this.products),console.log("products",this.products),this.getProductQuantity(),this.findGrandTotal()}))}else if(this.getCartItems(),this.products.length>0){const e={user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(this.products)};this.subscribe.push(this.apiService.addToCart(e).subscribe(e=>{200===e.code&&(sessionStorage.removeItem("cart"),sessionStorage.setItem("cartId",window.btoa(e.cart_details.id)),this.products=JSON.parse(e.cart_details.cart),this.getProductQuantity(),this.findGrandTotal(),this.apiService.totalItemsInCart())}))}}else null===sessionStorage.getItem("cardId")&&(this.getCartItems(),this.getProductQuantity(),this.toggleBtn=!1)}insertImages(e){let t;e.forEach(e=>{if(t="product"===e.type?e.description.split(" "):"","Surface"!==t[0]||"Close"!==t[2]&&"Bare"!==t[2])if("Multipurpose"!==t[0]||"Close"!==t[1]&&"Bare"!==t[1]){if("accessory"===e.type||"spare"===e.type)switch(e.code){case"Baseplate":e.img="assets/images/SparesImg/Baseplate_pic.png";break;case"DRP":e.img="assets/images/SparesImg/DRP_pic.png";break;case"Rotor":e.img="assets/images/SparesImg/rotor.jpg";break;case"Stator":e.img="assets/images/icons/stator.png";break;case"Mech Seal":e.img="assets/images/SparesImg/Mech_seal.jpeg";break;case"UJ M Kit":e.img="assets/images/SparesImg/UJ_KIT.jpg";break;case"Pump Lantern":e.img="assets/images/SparesImg/PUMPLANTERN.BMP";break;case"Foot":e.img="assets/images/SparesImg/FOOT.BMP";break;case"Tie Rod":e.img="assets/images/SparesImg/TIEROD.BMP";break;case"Pump Housing":e.img="assets/images/SparesImg/PUMPHOUSING.BMP";break;case"End Cover":e.img="assets/images/SparesImg/END_COVER.BMP";break;case"Seal Plate":e.img="assets/images/SparesImg/SEAL_PLATE.BMP";break;case"Mech Seal Housing":e.img="assets/images/SparesImg/MECHSEALHOUSING.BMP";break;case"Shaft Stub Price":e.img="assets/images/SparesImg/SHAFT.BMP";break;case"Coupling Rod":e.img="assets/images/SparesImg/COUPLINGROD.BMP";break;case"B.S.R. Retaining Ring":case"Boot Seal Reatainer":e.img="assets/images/SparesImg/BOOTSEALRETAINER.BMP";break;case"Boot Seal Support Ring":e.img="assets/images/SparesImg/Boot_Seal_Support_Ring.bmp";break;case"Boot Seal":e.img="assets/images/SparesImg/BOOT_SEAL.BMP";break;case"Foot And Face Mounted Motor 240v 4Pole":case"Foot And Face Mounted Motor 240v 6Pole":e.img="assets/images/SparesImg/Foot_face_mounted_motor.jpg";break;case"Bearing Cover":e.img="assets/images/SparesImg/BEARINGCOVER.BMP";break;case"Bearing Spacer External":e.img="assets/images/SparesImg/BEARINGSPACER.BMP";break;case"Mechanical Seal":e.img="assets/images/SparesImg/Mechanical-Seal_image.jpg";break;case"Ball_Bearing":e.img="assets/images/SparesImg/BALLBEARING.BMP";break;case"Foot Support For Stator Housing":e.img="assets/images/SparesImg/FOOT_FOR_STATOR_HOUSING.BMP";break;case"Foot Support For Bearing Housing":e.img="assets/images/SparesImg/FOOTFORBEARINGHOUSING.BMP";break;case"Stator Housing":e.img="assets/images/SparesImg/STATORHOUSING.BMP";break;case"Bonded Bush":e.img="assets/images/SparesImg/BONDEDBUSH.BMP";break;case"Bearning Housing":e.img="assets/images/SparesImg/BEARINGHOUSING.BMP";break;case"Ball Bearing Small":case"Ball Bearing Large":e.img="assets/images/SparesImg/BALLBEARING.BMP";break;case"Mech Seal Retainer":e.img="assets/images/SparesImg/MECHANICHALSEALRETAINER.BMP";break;case"Stator Support Ring":e.img="assets/images/SparesImg/STATOR_SUPPORT_RING.jpg";break;case"Drive Shaft":e.img="assets/images/SparesImg/SHAFT.BMP.BMP";break;case"Abutment Ring":e.img="assets/images/SparesImg/ABUTMENT_RING.jpg";break;case"Bearing":e.img="assets/images/SparesImg/BALLBEARING.BMP";break;default:e.img="assets/images/icons/accessories2.png"}}else e.img="assets/images/banner/DC.png";else e.img="assets/images/AGCACC/AGCApumpcopy.png"})}getProductQuantity(){this.productQuantity=0,this.products.forEach(e=>{this.productQuantity=e.productQuantity+this.productQuantity})}updateCartDetails(e,t){if("session"===t){const t=JSON.parse(e);let n=[];const r=[],o=[];null!==t&&(t.forEach(e=>{"product"===e.type?n.push(new d.a(e.productId,e.code,e.description,e.price,e.discountPrice,e.type,e.pole,e.flow,e.head,e.speed,e.power,e.engineSpeed,e.enginekW,e.driveType,e.productQuantity)):"accessory"===e.type?r.push(e):"spare"===e.type&&o.push(e)}),this.subscribe.push(this.activatedRoute.data.subscribe(e=>{let t=[];if(t=e.cartData,t.length<=0){n.length&&t.push(...n),r.length&&t.push(...r),o.length&&t.push(...o);const e={id:window.atob(sessionStorage.getItem("cartId")),user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(t)};this.apiService.updateCart(e).subscribe(t=>{200===t.code&&(sessionStorage.removeItem("cart"),this.apiService.getCartById(e.id).subscribe(e=>{200===e.code&&(this.products=JSON.parse(e.details.cart),this.insertImages(this.products),this.getProductQuantity(),this.findGrandTotal(),this.apiService.totalItemsInCart())}))})}else{const e=new Array,l=new Array;let a,i=!0,s=!0,d=!0;for(let m=0;m<t.length;m++)if("product"===t[m].type){d=!1;for(let e=0;e<n.length;e++)(""===t[m].driveType||t[m].driveType)===(""===n[e].driveType||n[e].driveType)&&t[m].code===n[e].code&&t[m].pole===n[e].pole?t[m].productQuantity++:a=n}else if("accessory"===t[m].type){s=!1;for(let n=0;n<r.length;n++)r[n].description===t[m].description&&r[n].driveType===t[m].driveType&&r[n].pole===t[m].pole?t[m].productQuantity++:t.some(e=>e.description===r[n].description&&e.pole===r[n].pole&&e.driveType===r[n].driveType)||e.some(e=>e.description===r[n].description&&e.pole===r[n].pole&&e.driveType===r[n].driveType)||e.push(r[n])}else if("spare"===t[m].type){i=!1;for(let e=0;e<o.length;e++)o[e].description===t[m].description&&o[e].pole===t[m].pole&&o[e].driveType===t[m].driveType?t[m].productQuantity++:t.some(t=>{var n;return t.description===o[e].description&&t.pole===o[e].pole&&t.driveType===(null===(n=o[e])||void 0===n?void 0:n.driveType)})||l.some(t=>{var n;return t.description===o[e].description&&t.pole===o[e].pole&&t.driveType===(null===(n=o[e])||void 0===n?void 0:n.driveType)})||l.push(o[e])}e.length>0&&t.push(...e),l.length>0&&t.push(...l),(void 0!==a||(null==a?void 0:a.length))&&t.push(...a),s&&t.push(...r),i&&t.push(...o),d&&t.push(...n);const c={id:window.atob(sessionStorage.getItem("cartId")),user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(t)};this.apiService.updateCart(c).subscribe(e=>{200===e.code&&(sessionStorage.removeItem("cart"),this.apiService.getCartById(c.id).subscribe(e=>{200===e.code&&(this.products=JSON.parse(e.details.cart),this.insertImages(this.products),this.getProductQuantity(),this.findGrandTotal(),this.apiService.totalItemsInCart())}))})}})))}else if("cart"===t){const t={id:window.atob(sessionStorage.getItem("cartId")),user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(e)};this.subscribe.push(this.apiService.updateCart(t).subscribe(e=>{200===e.code&&this.apiService.totalItemsInCart()}))}}getCartItems(){sessionStorage.getItem("cart")?(this.products=JSON.parse(window.atob(sessionStorage.getItem("cart"))),this.insertImages(this.products),this.findGrandTotal()):this.products=[]}findGrandTotal(){let e=0;this.products.forEach(t=>{t.productQuantity&&(e=(t.discountPrice>0?t.discountPrice:t.price)*t.productQuantity+e)}),this.grandTotal=e,this.shippingCharges=Math.round(+(.05*this.grandTotal).toFixed(3)),this.finalPrice=Math.round(this.grandTotal+this.shippingCharges),this.gstPrice=Math.round(+(.1*this.finalPrice).toFixed(3)),this.dealerDiscountAmount=Math.round(+(this.dealerDiscountPercentage*(this.finalPrice+this.gstPrice)).toFixed(3))}decrementProductQuantity(e){let t=this.products[e].productQuantity;if(t-=1,t<1){const t=document.getElementById("cartdeletemodal");t.classList.add("in"),t.style.display="block",this.deleteItemIndex=e;const n=this.products[this.deleteItemIndex].productId;if("product"===this.products[this.deleteItemIndex].type){const e=this.products.some(e=>"accessory"===e.type&&e.productId===n);this.showDeleteMsg=!!e}else this.showDeleteMsg=!1}else this.products[e].productQuantity=t,null===sessionStorage.getItem("id")?sessionStorage.setItem("cart",window.btoa(JSON.stringify(this.products))):this.updateCartDetails(this.products,"cart"),this.getProductQuantity();this.findGrandTotal()}removeItemFromCart(){let e;if(this.deleteItemIndex>-1){const t=this.products[this.deleteItemIndex].productId;"product"===this.products[this.deleteItemIndex].type&&(this.products=this.products.filter(e=>!("accessory"===e.type&&e.productId===t)),e=this.products.findIndex(e=>e.productId===t&&"product"===e.type)),void 0!==e&&-1!==e?(this.products.splice(e,1),this.products.forEach(e=>{"spare"===e.type&&e.productId===t&&(e.discountPrice=0)})):(this.products.splice(this.deleteItemIndex,1),this.products.forEach(e=>{"spare"===e.type&&e.productId===t&&(e.discountPrice=0)}))}null===sessionStorage.getItem("id")?sessionStorage.setItem("cart",window.btoa(JSON.stringify(this.products))):this.updateCartDetails(this.products,"cart");const t=document.getElementById("cartdeletemodal");t.classList.remove("in"),t.style.display="none",this.findGrandTotal(),this.apiService.totalItemsInCart()}closeDeleteModal(){const e=document.getElementById("cartdeletemodal");e.classList.remove("in"),e.style.display="none"}incrementProductQuantity(e){let t=this.products[e].productQuantity;t++,this.products[e].productQuantity=t,null===sessionStorage.getItem("id")?sessionStorage.setItem("cart",window.btoa(JSON.stringify(this.products))):this.updateCartDetails(this.products,"cart"),this.getProductQuantity(),this.findGrandTotal()}onContinue(e){sessionStorage.getItem("id")&&"continue"===e?sessionStorage.getItem("cartId")&&this.router.navigate(["./deliveryAddress"],{relativeTo:this.activatedRoute}):(sessionStorage.setItem("cart",window.btoa(JSON.stringify(this.products))),"sign-in"===e&&this.router.navigate(["/sign-in"],{queryParams:{origin:"cart"}}))}redirect(e){"sign-up"===e?this.router.navigate(["/sign-up"],{queryParams:{origin:"cart"}}):"sign-in"===e&&this.router.navigate(["/sign-in"],{queryParams:{origin:"cart"}})}ngOnDestroy(){this.subscribe.forEach(e=>{e&&e.unsubscribe()})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](c.a),l["\u0275\u0275directiveInject"](i.c),l["\u0275\u0275directiveInject"](i.a))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-cart-details"]],viewQuery:function(e,t){var n;1&e&&l["\u0275\u0275viewQuery"](u,!0),2&e&&l["\u0275\u0275queryRefresh"](n=l["\u0275\u0275loadQuery"]())&&(t.inputList=n.first)},decls:23,vars:5,consts:[[1,"main-container","cartpage"],[1,"breadcrum"],[1,"container"],["href","javascript:void(0)",3,"routerLink"],[4,"ngIf"],["id","cartdeletemodal","role","dialog",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-body"],[1,"delete-txt"],[1,"remove-sec"],["style","color: darkred;",4,"ngIf"],[1,"blue-button",3,"click"],[1,"cart-scale"],[1,"cart-scale-inner"],[1,"scale-no","active-scale"],[2,"pointer-events","none"],[1,"scale-no"],[1,"cart-section"],[1,"cart-inner"],[1,"cart"],[1,"price-title"],["class","cart-row cart-row-products",4,"ngFor","ngForOf"],[1,"price-detail"],["class","price-row",4,"ngFor","ngForOf"],[1,"price-row","total-price"],[1,"left-price-spare"],["class","left-price-spare",4,"ngIf"],["class","sign-button-sec",4,"ngIf"],[1,"cart-row","cart-row-products"],[1,"left-cart"],[1,"cart-pic"],["height","40px","width","40px",3,"src"],[1,"right-cart"],[1,"mid-cart"],[1,"number"],[1,"minus",3,"click"],["type","text","appNumOnly","","disabled","",3,"value"],[1,"plus",3,"click"],[1,"price-row"],["class","left-price",4,"ngIf","ngIfElse"],["productSpare",""],[1,"right-price"],[1,"left-price"],[1,"sign-button-sec"],[1,"tooltip",3,"click"],[1,"tooltiptext"],["href","javascript:void(0)",3,"click"],[1,"epmtyCartImg"],["src","assets/images/icons/EmptyCart.svg"],["class","emptyCartMsg",4,"ngIf"],[1,"emptyCartMsg"],[3,"click"],[2,"color","darkred"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"p"),l["\u0275\u0275elementStart"](4,"a",3),l["\u0275\u0275text"](5,"Home"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"span"),l["\u0275\u0275text"](7,"/"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](8," Cart"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](9,x,52,8,"ng-container",4),l["\u0275\u0275template"](10,P,5,2,"ng-container",4),l["\u0275\u0275elementStart"](11,"div",5),l["\u0275\u0275elementStart"](12,"div",6),l["\u0275\u0275elementStart"](13,"div",7),l["\u0275\u0275elementStart"](14,"div",8),l["\u0275\u0275elementStart"](15,"div",9),l["\u0275\u0275elementStart"](16,"div",10),l["\u0275\u0275text"](17,"Are you sure to remove this item? "),l["\u0275\u0275template"](18,T,2,0,"p",11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](19,"button",12),l["\u0275\u0275listener"]("click",(function(){return t.removeItemFromCart()})),l["\u0275\u0275text"](20,"Yes"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](21,"button",12),l["\u0275\u0275listener"]("click",(function(){return t.closeDeleteModal()})),l["\u0275\u0275text"](22,"Cancel"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](4,A)),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("ngIf",t.products.length>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",0==t.products.length),l["\u0275\u0275advance"](8),l["\u0275\u0275property"]("ngIf",t.showDeleteMsg))},directives:[i.f,r.NgIf,r.NgForOf,m.a],styles:[""]}),e})();var D=n("JqCM"),O=n("ZSuO");function k(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",17),l["\u0275\u0275elementStart"](1,"input",44),l["\u0275\u0275listener"]("change",(function(){l["\u0275\u0275restoreView"](e);const n=t.$implicit;return l["\u0275\u0275nextContext"]().getSelectedAddress(n)})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](2,"label",45),l["\u0275\u0275text"](3),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index;l["\u0275\u0275advance"](1),l["\u0275\u0275propertyInterpolate"]("id","address-"+n),l["\u0275\u0275property"]("checked",0===n),l["\u0275\u0275advance"](1),l["\u0275\u0275propertyInterpolate"]("for","address-"+n),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate5"]("",null==e?null:e.house_no," ",null==e?null:e.city," ",null==e?null:e.state," ",null==e?null:e.country," ",null==e?null:e.pincode,"")}}function M(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1," Select title"),l["\u0275\u0275elementEnd"]())}function B(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1,"First name is required"),l["\u0275\u0275elementEnd"]())}function F(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275template"](1,B,2,0,"p",28),l["\u0275\u0275elementContainerEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.formControl||null==e.formControl.first_name?null:e.formControl.first_name.errors.required)}}function j(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1,"Last name is required"),l["\u0275\u0275elementEnd"]())}function U(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275template"](1,j,2,0,"p",28),l["\u0275\u0275elementContainerEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.formControl||null==e.formControl.last_name?null:e.formControl.last_name.errors.required)}}function q(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1,"Phone number is required"),l["\u0275\u0275elementEnd"]())}function L(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1,"Enter valid phone number"),l["\u0275\u0275elementEnd"]())}function Q(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275template"](1,q,2,0,"p",28),l["\u0275\u0275template"](2,L,2,0,"p",28),l["\u0275\u0275elementContainerEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.formControl||null==e.formControl.phone?null:e.formControl.phone.errors.required),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.formControl||null==e.formControl.phone?null:e.formControl.phone.errors.pattern)}}function R(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1," Address is required"),l["\u0275\u0275elementEnd"]())}function G(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"option",47),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275propertyInterpolate"]("value",null==e?null:e.name),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](e.name)}}function J(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1," Select country from list"),l["\u0275\u0275elementEnd"]())}function $(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"option",47),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275propertyInterpolate"]("value",null==e?null:e.name),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name,"")}}function H(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1," Select state from list"),l["\u0275\u0275elementEnd"]())}function V(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"option",47),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275propertyInterpolate"]("value",null==e?null:e.name),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name,"")}}function z(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1," Select city"),l["\u0275\u0275elementEnd"]())}function K(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1,"Postal code is required"),l["\u0275\u0275elementEnd"]())}function Y(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",46),l["\u0275\u0275text"](1,"Enter valid postal code"),l["\u0275\u0275elementEnd"]())}function Z(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275template"](1,K,2,0,"p",28),l["\u0275\u0275template"](2,Y,2,0,"p",28),l["\u0275\u0275elementContainerEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.formControl||null==e.formControl.pincode?null:e.formControl.pincode.errors.required),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.formControl||null==e.formControl.pincode?null:e.formControl.pincode.errors.pattern)}}function W(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p"),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("(",null==e?null:e.driveType,")")}}function X(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",59),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](3,W,2,1,"p",32),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](null==e?null:e.description),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",""!==(null==e?null:e.driveType))}}function ee(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p"),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("(",null==e?null:e.description,")")}}function te(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",59),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](3,ee,2,1,"p",32),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](null==e?null:e.code),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",""!==(null==e?null:e.description))}}function ne(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",55),l["\u0275\u0275template"](1,X,4,2,"div",56),l["\u0275\u0275template"](2,te,4,2,"ng-template",null,57,l["\u0275\u0275templateRefExtractor"]),l["\u0275\u0275elementStart"](4,"div",58),l["\u0275\u0275elementStart"](5,"h3"),l["\u0275\u0275text"](6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=l["\u0275\u0275reference"](3);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf","spare"!==(null==e?null:e.type))("ngIfElse",n),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"]("$ ",(null==e?null:e.productQuantity)*((null==e?null:e.discountPrice)>0?null==e?null:e.discountPrice:null==e?null:e.price),"")}}function re(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",52),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2,"Dealer Discount (10%) "),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275text"](4," (In AUD)"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"h3"),l["\u0275\u0275text"](6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](6),l["\u0275\u0275textInterpolate1"]("$",e.finalPrice+e.gstPrice-e.dealerDiscountAmount,"")}}function oe(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"button",60),l["\u0275\u0275elementStart"](1,"a",61),l["\u0275\u0275text"](2,"Checkout "),l["\u0275\u0275elementStart"](3,"span",62),l["\u0275\u0275text"](4,"Please enter your address to continue"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]())}function le(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button"),l["\u0275\u0275elementStart"](1,"a",63),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"](2).checkOut()})),l["\u0275\u0275text"](2,"Checkout"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}}function ae(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",48),l["\u0275\u0275elementStart"](1,"h3",49),l["\u0275\u0275text"](2,"Price Detail"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](3,ne,7,3,"div",50),l["\u0275\u0275elementStart"](4,"div",51),l["\u0275\u0275elementStart"](5,"div",52),l["\u0275\u0275elementStart"](6,"h3"),l["\u0275\u0275text"](7,"Sub Total"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](8,"h3"),l["\u0275\u0275text"](9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",52),l["\u0275\u0275elementStart"](11,"h3"),l["\u0275\u0275text"](12,"Shipping & Handling"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"h3"),l["\u0275\u0275text"](14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"div",52),l["\u0275\u0275elementStart"](16,"h3"),l["\u0275\u0275text"](17,"Total (including GST@10%) "),l["\u0275\u0275element"](18,"br"),l["\u0275\u0275text"](19,"(In AUD)"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"h3"),l["\u0275\u0275text"](21),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](22,re,7,1,"div",53),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](23,oe,5,0,"button",54),l["\u0275\u0275template"](24,le,3,0,"button",32),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngForOf",e.products),l["\u0275\u0275advance"](6),l["\u0275\u0275textInterpolate1"]("$",e.grandTotal,""),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"]("$",e.shippingCharges,""),l["\u0275\u0275advance"](7),l["\u0275\u0275textInterpolate1"]("$",e.finalPrice+e.gstPrice,""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.applyDealerDiscount),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.emptyAddress),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!e.emptyAddress)}}const ie=function(){return["/home"]},se=function(){return["/cart"]},de=function(e){return{display:e}};let ce=(()=>{class e{constructor(e,t,n,r,o){this.apiService=e,this.fb=t,this.toaster=n,this.route=r,this.spinner=o,this.products=[],this.grandTotal=0,this.shippingCharges=0,this.finalPrice=0,this.toggleAddress="",this.subscribe=[],this.emptyAddress=!1,this.stateInfo=[],this.countryInfo=[],this.cityInfo=[],this.buyNowCartId="",this.toggleCanDeactivate=!0,this.applyDealerDiscount=!1,this.dealerDiscountAmount=0}ngOnInit(){if(this.spinner.show(),sessionStorage.getItem("id")&&(this.userId=window.atob(sessionStorage.getItem("id")),this.getAddressList(window.atob(sessionStorage.getItem("id")))),"Dealer"===window.atob(sessionStorage.getItem("userType"))&&"D"===window.atob(sessionStorage.getItem("userStatus")))if(this.applyDealerDiscount=!0,null===window.atob(sessionStorage.getItem("userDiscount")))this.apiService.dealerDiscount().subscribe(e=>{!0===e.return&&(this.dealerDiscountPercentage=e.data[0].discount_rate,this.dealerDiscountPercentage=.01*this.dealerDiscountPercentage)});else{let e=window.atob(sessionStorage.getItem("userDiscount"));this.dealerDiscountPercentage=.01*+e}if(sessionStorage.getItem("buyNow")){this.getCartItems();const e={user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(this.products)};this.apiService.addToCart(e).subscribe(e=>{200===e.code&&(this.buyNowCartId=e.cart_details.id)})}else this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem("cartId"))).subscribe(e=>{200===e.code&&(this.products=JSON.parse(e.details.cart),this.findGrandTotal())},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message))}));this.getCountries(),this.createAddressForm()}getSelectedAddress(e){"newAddress"!==e?(this.selectedAddress=e,this.toggleAddress="",this.emptyAddress=!1):(this.toggleAddress="newAddress",this.emptyAddress=!0,this.getUserDetails(this.userId))}getCartItems(){this.products=JSON.parse(window.atob(sessionStorage.getItem("buyNow"))),this.findGrandTotal()}findGrandTotal(){let e=0;this.products.forEach(t=>{t.productQuantity&&(e=(t.discountPrice>0?t.discountPrice:t.price)*t.productQuantity+e)}),this.grandTotal=e,this.shippingCharges=Math.round(+(.05*this.grandTotal).toFixed(3)),this.finalPrice=Math.round(this.grandTotal+this.shippingCharges),this.gstPrice=Math.round(+(.1*this.finalPrice).toFixed(3)),this.dealerDiscountAmount=Math.round(+(this.dealerDiscountPercentage*(this.finalPrice+this.gstPrice)).toFixed(3));const t=window.btoa(JSON.stringify({subtotal_amount:this.grandTotal,shipping_amount:this.shippingCharges,gst_amount:this.gstPrice}));sessionStorage.setItem("additionalPaymentDetails",t)}getCountries(){this.subscribe.push(this.apiService.getCountryData().subscribe(e=>{e&&(this.countryInfo=e.countries,this.onChangeCountry("Australia"))}))}getAddressList(e){this.subscribe.push(this.apiService.getAllAddress({user_id:+e}).subscribe(e=>{200===e.code&&(this.addressList=e.address,this.spinner.hide(),this.addressList.length>0?(this.selectedAddress=e.address[0],this.emptyAddress=!1):(this.emptyAddress=!0,this.getSelectedAddress("newAddress")))},e=>{this.toaster.error("No address found"),this.spinner.hide()}))}getUserDetails(e){this.apiService.getUserDetails(e).subscribe(e=>{e.code&&this.patchAddressForm(e.details.name)})}patchAddressForm(e){const t=e.split(" ");3===t.length?this.addressForm.patchValue({first_name:t[0],middle_name:t[1],last_name:t[2]}):t.length>1&&t.length<=2?this.addressForm.patchValue({first_name:t[0],last_name:t[1]}):1===t.length&&this.addressForm.patchValue({first_name:t[0]})}onChangeCountry(e){this.cityInfo=[];const t=this.countryInfo.findIndex(t=>t.name===e);this.stateInfo=this.countryInfo[t].states}onChangeState(e){const t=this.stateInfo.findIndex(t=>t.name===e);this.cityInfo=this.stateInfo[t].cities}createAddressForm(){this.addressForm=this.fb.group({title:new o.c("",o.q.required),first_name:new o.c("",o.q.required),middle_name:new o.c(""),last_name:new o.c("",o.q.required),phone:new o.c("",[o.q.pattern("[0-9 ]{10,12}"),o.q.required]),house_no:new o.c("",o.q.required),city:new o.c("",o.q.required),state:new o.c("",o.q.required),pincode:new o.c("",[o.q.pattern("[0-9 ]{4}"),o.q.required]),country:new o.c("Australia",o.q.required)})}get formControl(){return this.addressForm.controls}onInputChange(e,t){let n=0;"phone"===t?(n=12,e.length>=n&&this.addressForm.patchValue({phone:e.substring(0,12)})):"zip"===t&&(n=4,e.length>=n&&this.addressForm.patchValue({pincode:e.substring(0,4)}))}validateAllFields(e){Object.keys(this.formControl).forEach(t=>{const n=e.get(t);n instanceof o.c?n.markAsTouched({onlySelf:!0}):n instanceof o.e&&this.validateAllFields(n)})}saveAddress(e){e.invalid?this.validateAllFields(e):(e.value.user_id=+this.userId,this.subscribe.push(this.apiService.addAddress(e.value).subscribe(t=>{200===t.code&&(this.toaster.success(t.message),this.getAddressList(this.userId),this.toggleAddress="",e.reset())},e=>{var t;this.toaster.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message))})))}updateCart(){const e=JSON.parse(window.atob(sessionStorage.getItem("buyNow")));let t;console.log(e,"cartLocal");const n=[],r=[];null!==e&&e.forEach(e=>{"product"===e.type?t=new d.a(e.productId,e.code,e.description,e.price,e.discountPrice,e.type,e.pole,e.flow,e.head,e.speed,e.power,e.engineSpeed,e.enginekW,e.driveType,e.productQuantity):"accessory"===e.type?n.push(e):"spare"===e.type&&r.push(e)}),this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem("cartId"))).subscribe(e=>{if(200===e.code){let o=[];if(o=JSON.parse(e.details.cart),console.log(o,"cartDetails"),o.length<=0)o.push(t),o.push(...n),o.push(...r);else{const e=new Array,l=new Array;let a,i=!0,s=!0;for(let d=0;d<o.length;d++)if("product"===o[d].type)o[d].driveType===t.driveType&&o[d].code===t.code&&o[d].pole===t.pole?o[d].productQuantity++:a=t;else if("accessory"===o[d].type){s=!1;for(let t=0;t<n.length;t++)n[t].description===o[d].description&&n[t].pole===o[d].pole&&n[t].driveType===o[d].driveType?o[d].productQuantity++:o.some(e=>e.description===n[t].description&&e.pole===n[t].pole&&e.driveType===n[t].driveType)||e.some(e=>e.description===n[t].description&&e.pole===n[t].pole&&e.driveType===n[t].driveType)||e.push(n[t])}else if("spare"===o[d].type){i=!1;for(let e=0;e<r.length;e++)r[e].description===o[d].description&&r[e].pole===o[d].pole&&r[e].driveType===o[d].driveType?o[d].productQuantity++:o.some(t=>t.description===r[e].description&&t.pole===r[e].pole&&t.driveType===r[e].driveType)||l.some(t=>t.description===r[e].description&&t.pole===r[e].pole&&t.driveType===r[e].driveType)||l.push(r[e])}e.length>0&&o.push(...e),l.length>0&&o.push(...l),a.length>0&&(o.push(a),console.log(o,"push")),s&&o.push(...n),i&&o.push(...r)}const l={id:window.atob(sessionStorage.getItem("cartId")),user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(o)};return this.subscribe.push(this.apiService.updateCart(l).subscribe(e=>{200===e.code&&(this.buyNowCartId=l.id,sessionStorage.removeItem("buyNow"),this.apiService.totalItemsInCart())}))}}))}checkOut(){var e,t;""===this.toggleAddress?(this.toggleCanDeactivate=!1,this.route.navigate(""!==this.buyNowCartId?["/cart/payment",null===(e=this.selectedAddress)||void 0===e?void 0:e.id,this.buyNowCartId]:["/cart/payment",null===(t=this.selectedAddress)||void 0===t?void 0:t.id,window.atob(sessionStorage.getItem("cartId"))])):this.toaster.success("Please add and select one address to continue")}canDeactivate(){if(this.toggleCanDeactivate){if(sessionStorage.getItem("cartId")){if(sessionStorage.getItem("buyNow")){const e=JSON.parse(window.atob(sessionStorage.getItem("buyNow"))),t=[],n=[];let r;return null!==e&&e.forEach(e=>{"product"===e.type?r=new d.a(e.productId,e.code,e.description,e.price,e.discountPrice,e.type,e.pole,e.flow,e.head,e.speed,e.power,e.engineSpeed,e.enginekW,e.driveType,e.productQuantity):"accessory"===e.type?t.push(e):"spare"===e.type&&n.push(e)}),new Promise(e=>{this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem("cartId"))).subscribe(o=>{if(200===o.code){let l=[];if(l=JSON.parse(o.details.cart),console.log("cartDetails",l),l.length<=0)l.push(Object.assign({},r)),l.push(...t),l.push(...n);else{const e=new Array,o=new Array;let a={},i=!0,s=!0,d=!0;for(let c=0;c<l.length;c++)if("product"===l[c].type)d=!1,(""===l[c].driveType||l[c].driveType)===(""===r.driveType||r.driveType)&&l[c].code===r.code&&l[c].pole===r.pole?l[c].productQuantity++:a=r;else if("accessory"===l[c].type){s=!1;for(let n=0;n<t.length;n++)t[n].description===l[c].description&&t[n].pole===l[c].pole&&t[n].driveType===l[c].driveType?l[c].productQuantity++:l.some(e=>e.description===t[n].description&&e.pole===t[n].pole&&e.driveType===t[n].driveType)||e.some(e=>e.description===t[n].description&&e.pole===t[n].pole&&e.driveType===t[n].driveType)||e.push(t[n])}else if("spare"===l[c].type){i=!1;for(let e=0;e<n.length;e++)n[e].description===l[c].description&&n[e].pole===l[c].pole&&n[e].driveType===l[c].driveType?l[c].productQuantity++:l.some(t=>t.description===n[e].description&&t.pole===n[e].pole&&t.driveType===n[e].driveType)||o.some(t=>t.description===n[e].description&&t.pole===n[e].pole&&t.driveType===n[e].driveType)||o.push(n[e])}e.length>0&&l.push(...e),o.length>0&&l.push(...o),Object.keys(a).length>0&&l.push(Object.assign({},a)),s&&l.push(...t),i&&l.push(...n),d&&l.push(Object.assign({},r))}const a={id:window.atob(sessionStorage.getItem("cartId")),user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(l)};return console.log(l,"ooo"),this.subscribe.push(this.apiService.updateCart(a).subscribe(t=>{if(200===t.code)return sessionStorage.removeItem("buyNow"),this.apiService.totalItemsInCart(),e(!0)}))}}))})}return!0}return sessionStorage.setItem("cartId",window.btoa(this.buyNowCartId)),this.apiService.totalItemsInCart(),sessionStorage.removeItem("buyNow"),!0}return!0}ngOnDestroy(){this.subscribe.forEach(e=>{e&&e.unsubscribe()})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](c.a),l["\u0275\u0275directiveInject"](o.b),l["\u0275\u0275directiveInject"](a.b),l["\u0275\u0275directiveInject"](i.c),l["\u0275\u0275directiveInject"](D.c))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-cart-address"]],decls:137,vars:33,consts:[["bdColor","rgb(0,0,0)","size","medium","color","#2e94ef","type","ball-newton-cradle",3,"fullScreen"],[2,"color","white"],[1,"main-container","cartpage","addresspage"],[1,"breadcrum"],[1,"container"],["href","javascript:void(0)",3,"routerLink"],[1,"cart-scale"],[1,"cart-scale-inner"],[1,"scale-no","active-scale"],[2,"pointer-events","none"],[1,"scale-no"],[1,"cart-section"],[1,"cart-inner"],[1,"cart"],[1,"address-row","same-add-row"],[1,"same-address"],["class","address-box",4,"ngFor","ngForOf"],[1,"address-box"],["type","radio","name","address","id","address",3,"checked","change"],["for","address"],[1,"address-row",3,"ngStyle"],[3,"formGroup"],[1,"address-feild"],["formControlName","title","required","",3,"ngClass"],["value","","selected","","disabled",""],["value","Mr"],["value","Ms"],["value"," "],["class","error-addressMsg",4,"ngIf"],[1,"name-container"],[1,"address-feild","address2"],["type","text","placeholder","First Name","formControlName","first_name","appTextOnly","","required","",3,"ngClass"],[4,"ngIf"],["type","text","placeholder","Middle Name","appTextOnly","","formControlName","middle_name"],["type","text","placeholder","Last Name","formControlName","last_name","appTextOnly","","required","",3,"ngClass"],["type","text","placeholder","Contact Number","appNumOnly","","formControlName","phone","required","",3,"ngClass","input"],["type","text","placeholder","Address","formControlName","house_no","required","",3,"ngClass"],["formControlName","country","required","",3,"ngClass","change"],[3,"value",4,"ngFor","ngForOf"],["formControlName","state","required","",3,"ngClass","change"],["formControlName","city","required","",3,"ngClass"],["type","text","placeholder","1234","appNumOnly","","formControlName","pincode","required","",3,"ngClass","input"],[1,"blue-button",3,"click"],["class","price-detail",4,"ngIf"],["type","radio","name","address",3,"id","checked","change"],[3,"for"],[1,"error-addressMsg"],[3,"value"],[1,"price-detail"],[1,"price-title"],["class","price-row",4,"ngFor","ngForOf"],[1,"price-row","total-price"],[1,"left-price-spare"],["class","left-price-spare",4,"ngIf"],["disabled","",4,"ngIf"],[1,"price-row"],["class","left-price",4,"ngIf","ngIfElse"],["productSpare",""],[1,"right-price"],[1,"left-price"],["disabled",""],[1,"tooltip"],[1,"tooltiptext"],[1,"tooltip",3,"click"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"ngx-spinner",0),l["\u0275\u0275elementStart"](1,"p",1),l["\u0275\u0275text"](2," Loading... "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"div",2),l["\u0275\u0275elementStart"](4,"div",3),l["\u0275\u0275elementStart"](5,"div",4),l["\u0275\u0275elementStart"](6,"p"),l["\u0275\u0275elementStart"](7,"a",5),l["\u0275\u0275text"](8,"Home"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](9," / "),l["\u0275\u0275elementStart"](10,"a",5),l["\u0275\u0275text"](11,"Cart"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"span"),l["\u0275\u0275text"](13,"/"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](14," Address"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"div",6),l["\u0275\u0275elementStart"](16,"div",4),l["\u0275\u0275elementStart"](17,"div",7),l["\u0275\u0275elementStart"](18,"div",8),l["\u0275\u0275elementStart"](19,"a",9),l["\u0275\u0275text"](20,"1"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](21,"small"),l["\u0275\u0275text"](22,"Cart"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](23,"div",10),l["\u0275\u0275elementStart"](24,"a",9),l["\u0275\u0275text"](25,"2"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](26,"small"),l["\u0275\u0275text"](27,"Address"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](28,"div",10),l["\u0275\u0275elementStart"](29,"a",9),l["\u0275\u0275text"](30,"3"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](31,"small"),l["\u0275\u0275text"](32,"Payment"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](33,"div",11),l["\u0275\u0275elementStart"](34,"div",4),l["\u0275\u0275elementStart"](35,"div",12),l["\u0275\u0275elementStart"](36,"div",13),l["\u0275\u0275elementStart"](37,"div",14),l["\u0275\u0275elementStart"](38,"h3"),l["\u0275\u0275text"](39,"Use saved addresses"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](40,"div",15),l["\u0275\u0275template"](41,k,4,8,"div",16),l["\u0275\u0275elementStart"](42,"div",17),l["\u0275\u0275elementStart"](43,"input",18),l["\u0275\u0275listener"]("change",(function(){return t.getSelectedAddress("newAddress")})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](44,"label",19),l["\u0275\u0275text"](45,"New Address"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](46,"div",20),l["\u0275\u0275elementStart"](47,"h3"),l["\u0275\u0275text"](48,"Contact Detail"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](49,"form",21),l["\u0275\u0275elementStart"](50,"div",22),l["\u0275\u0275elementStart"](51,"label"),l["\u0275\u0275text"](52,"Title "),l["\u0275\u0275elementStart"](53,"span"),l["\u0275\u0275text"](54,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](55,"select",23),l["\u0275\u0275elementStart"](56,"option",24),l["\u0275\u0275text"](57,"Select title"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](58,"option",25),l["\u0275\u0275text"](59,"Mr."),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](60,"option",26),l["\u0275\u0275text"](61,"Ms."),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](62,"option",27),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](63,M,2,0,"p",28),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](64,"div",29),l["\u0275\u0275elementStart"](65,"div",30),l["\u0275\u0275elementStart"](66,"label"),l["\u0275\u0275text"](67,"First Name"),l["\u0275\u0275elementStart"](68,"span"),l["\u0275\u0275text"](69,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](70,"input",31),l["\u0275\u0275template"](71,F,2,1,"ng-container",32),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](72,"div",30),l["\u0275\u0275elementStart"](73,"label"),l["\u0275\u0275text"](74,"Middle Name"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](75,"input",33),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](76,"div",30),l["\u0275\u0275elementStart"](77,"label"),l["\u0275\u0275text"](78,"Last Name "),l["\u0275\u0275elementStart"](79,"span"),l["\u0275\u0275text"](80,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](81,"input",34),l["\u0275\u0275template"](82,U,2,1,"ng-container",32),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](83,"div",22),l["\u0275\u0275elementStart"](84,"label"),l["\u0275\u0275text"](85,"Contact Number "),l["\u0275\u0275elementStart"](86,"span"),l["\u0275\u0275text"](87,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](88,"input",35),l["\u0275\u0275listener"]("input",(function(e){return t.onInputChange(e.target.value,"phone")})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](89,Q,3,2,"ng-container",32),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](90,"h3"),l["\u0275\u0275text"](91,"Address"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](92,"div",22),l["\u0275\u0275elementStart"](93,"label"),l["\u0275\u0275text"](94,"Address (House No., Building , Street, Area) "),l["\u0275\u0275elementStart"](95,"span"),l["\u0275\u0275text"](96,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](97,"input",36),l["\u0275\u0275template"](98,R,2,0,"p",28),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](99,"div",22),l["\u0275\u0275elementStart"](100,"label"),l["\u0275\u0275text"](101,"Country "),l["\u0275\u0275elementStart"](102,"span"),l["\u0275\u0275text"](103,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](104,"select",37),l["\u0275\u0275listener"]("change",(function(e){return t.onChangeCountry(e.target.value)})),l["\u0275\u0275template"](105,G,2,2,"option",38),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](106,J,2,0,"p",28),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](107,"div",22),l["\u0275\u0275elementStart"](108,"label"),l["\u0275\u0275text"](109,"State "),l["\u0275\u0275elementStart"](110,"span"),l["\u0275\u0275text"](111,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](112,"select",39),l["\u0275\u0275listener"]("change",(function(e){return t.onChangeState(e.target.value)})),l["\u0275\u0275elementStart"](113,"option",24),l["\u0275\u0275text"](114,"Please select state"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](115,$,2,2,"option",38),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](116,H,2,0,"p",28),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](117,"div",22),l["\u0275\u0275elementStart"](118,"label"),l["\u0275\u0275text"](119,"City "),l["\u0275\u0275elementStart"](120,"span"),l["\u0275\u0275text"](121,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](122,"select",40),l["\u0275\u0275elementStart"](123,"option",24),l["\u0275\u0275text"](124,"Please select state first"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](125,V,2,2,"option",38),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](126,z,2,0,"p",28),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](127,"div",22),l["\u0275\u0275elementStart"](128,"label"),l["\u0275\u0275text"](129,"Postal code"),l["\u0275\u0275elementStart"](130,"span"),l["\u0275\u0275text"](131,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](132,"input",41),l["\u0275\u0275listener"]("input",(function(e){return t.onInputChange(e.target.value,"zip")})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](133,Z,3,2,"ng-container",32),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](134,"div",42),l["\u0275\u0275listener"]("click",(function(){return t.saveAddress(t.addressForm)})),l["\u0275\u0275text"](135,"Save this address"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](136,ae,25,7,"div",43),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("fullScreen",!0),l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](29,ie)),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](30,se)),l["\u0275\u0275advance"](31),l["\u0275\u0275property"]("ngForOf",t.addressList),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",t.emptyAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngStyle",l["\u0275\u0275pureFunction1"](31,de,"newAddress"===t.toggleAddress?"flex":"none")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formGroup",t.addressForm),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",null!=t.formControl&&null!=t.formControl.title&&t.formControl.title.invalid&&(null!=t.formControl&&null!=t.formControl.title&&t.formControl.title.touched||null!=t.formControl&&null!=t.formControl.title&&t.formControl.title.dirty)?"red":null!=t.formControl&&null!=t.formControl.title&&t.formControl.title.valid&&(null!=t.formControl&&null!=t.formControl.title&&t.formControl.title.touched||null!=t.formControl&&null!=t.formControl.title&&t.formControl.title.dirty)?"green":""),l["\u0275\u0275advance"](8),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.title?null:t.formControl.title.invalid)&&((null==t.formControl||null==t.formControl.title?null:t.formControl.title.touched)||(null==t.formControl||null==t.formControl.title?null:t.formControl.title.dirty))),l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("ngClass",null!=t.formControl&&null!=t.formControl.first_name&&null!=t.formControl.first_name.errors&&t.formControl.first_name.errors.required&&(null!=t.formControl&&null!=t.formControl.first_name&&t.formControl.first_name.touched||null!=t.formControl&&null!=t.formControl.first_name&&t.formControl.first_name.dirty)?"red":null!=t.formControl&&null!=t.formControl.first_name&&t.formControl.first_name.valid&&(null!=t.formControl&&null!=t.formControl.first_name&&t.formControl.first_name.touched||null!=t.formControl&&null!=t.formControl.first_name&&t.formControl.first_name.dirty)?"green":""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.first_name?null:t.formControl.first_name.invalid)&&((null==t.formControl||null==t.formControl.first_name?null:t.formControl.first_name.touched)||(null==t.formControl||null==t.formControl.first_name?null:t.formControl.first_name.dirty))),l["\u0275\u0275advance"](10),l["\u0275\u0275property"]("ngClass",null!=t.formControl&&null!=t.formControl.last_name&&null!=t.formControl.last_name.errors&&t.formControl.last_name.errors.required&&(null!=t.formControl&&null!=t.formControl.last_name&&t.formControl.last_name.touched||null!=t.formControl&&null!=t.formControl.last_name&&t.formControl.last_name.dirty)?"red":null!=t.formControl&&null!=t.formControl.last_name&&t.formControl.last_name.valid&&(null!=t.formControl&&null!=t.formControl.last_name&&t.formControl.last_name.touched||null!=t.formControl&&null!=t.formControl.last_name&&t.formControl.last_name.dirty)?"green":""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.last_name?null:t.formControl.last_name.invalid)&&((null==t.formControl||null==t.formControl.last_name?null:t.formControl.last_name.touched)||(null==t.formControl||null==t.formControl.last_name?null:t.formControl.last_name.dirty))),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",(null!=t.formControl&&null!=t.formControl.phone&&null!=t.formControl.phone.errors&&t.formControl.phone.errors.required||null!=t.formControl&&null!=t.formControl.phone&&null!=t.formControl.phone.errors&&t.formControl.phone.errors.pattern)&&(null!=t.formControl&&null!=t.formControl.phone&&t.formControl.phone.touched||null!=t.formControl&&null!=t.formControl.phone&&t.formControl.phone.dirty)?"red":null!=t.formControl&&null!=t.formControl.phone&&t.formControl.phone.valid&&(null!=t.formControl&&null!=t.formControl.phone&&t.formControl.phone.touched||null!=t.formControl&&null!=t.formControl.phone&&t.formControl.phone.dirty)?"green":""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.phone?null:t.formControl.phone.invalid)&&((null==t.formControl||null==t.formControl.phone?null:t.formControl.phone.touched)||(null==t.formControl||null==t.formControl.phone?null:t.formControl.phone.dirty))),l["\u0275\u0275advance"](8),l["\u0275\u0275property"]("ngClass",null!=t.formControl&&null!=t.formControl.house_no&&t.formControl.house_no.invalid&&(null!=t.formControl&&null!=t.formControl.house_no&&t.formControl.house_no.touched||null!=t.formControl&&null!=t.formControl.house_no&&t.formControl.house_no.dirty)?"red":null!=t.formControl&&null!=t.formControl.house_no&&t.formControl.house_no.valid&&(null!=t.formControl&&null!=t.formControl.house_no&&t.formControl.house_no.touched||null!=t.formControl&&null!=t.formControl.house_no&&t.formControl.house_no.dirty)?"green":""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.house_no?null:t.formControl.house_no.invalid)&&((null==t.formControl||null==t.formControl.house_no?null:t.formControl.house_no.touched)||(null==t.formControl||null==t.formControl.house_no?null:t.formControl.house_no.dirty))),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",null!=t.formControl&&null!=t.formControl.country&&t.formControl.country.invalid&&(null!=t.formControl&&null!=t.formControl.country&&t.formControl.country.touched||null!=t.formControl&&null!=t.formControl.country&&t.formControl.country.dirty)?"red":null!=t.formControl&&null!=t.formControl.country&&t.formControl.country.valid&&(null!=t.formControl&&null!=t.formControl.country&&t.formControl.country.touched||null!=t.formControl&&null!=t.formControl.country&&t.formControl.country.dirty)?"green":""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",t.countryInfo),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.country?null:t.formControl.country.invalid)&&((null==t.formControl||null==t.formControl.country?null:t.formControl.country.touched)||(null==t.formControl||null==t.formControl.country?null:t.formControl.country.dirty))),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",null!=t.formControl&&null!=t.formControl.state&&t.formControl.state.invalid&&(null!=t.formControl&&null!=t.formControl.state&&t.formControl.state.touched||null!=t.formControl&&null!=t.formControl.state&&t.formControl.state.dirty)?"red":null!=t.formControl&&null!=t.formControl.state&&t.formControl.state.valid&&(null!=t.formControl&&null!=t.formControl.state&&t.formControl.state.touched||null!=t.formControl&&null!=t.formControl.state&&t.formControl.state.dirty)?"green":""),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngForOf",t.stateInfo),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.state?null:t.formControl.state.invalid)&&((null==t.formControl||null==t.formControl.state?null:t.formControl.state.touched)||(null==t.formControl||null==t.formControl.state?null:t.formControl.state.dirty))),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",null!=t.formControl&&null!=t.formControl.city&&t.formControl.city.invalid&&(null!=t.formControl&&null!=t.formControl.city&&t.formControl.city.touched||null!=t.formControl&&null!=t.formControl.city&&t.formControl.city.dirty)?"red":null!=t.formControl&&null!=t.formControl.city&&t.formControl.city.valid&&(null!=t.formControl&&null!=t.formControl.city&&t.formControl.city.touched||null!=t.formControl&&null!=t.formControl.city&&t.formControl.city.dirty)?"green":""),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngForOf",t.cityInfo),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.city?null:t.formControl.city.invalid)&&((null==t.formControl||null==t.formControl.city?null:t.formControl.city.touched)||(null==t.formControl||null==t.formControl.city?null:t.formControl.city.dirty))),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",(null!=t.formControl&&null!=t.formControl.pincode&&null!=t.formControl.pincode.errors&&t.formControl.pincode.errors.required||null!=t.formControl&&null!=t.formControl.pincode&&null!=t.formControl.pincode.errors&&t.formControl.pincode.errors.pattern)&&(null!=t.formControl&&null!=t.formControl.pincode&&t.formControl.pincode.touched||null!=t.formControl&&null!=t.formControl.pincode&&t.formControl.pincode.dirty)?"red":null!=t.formControl&&null!=t.formControl.pincode&&t.formControl.pincode.valid&&(null!=t.formControl&&null!=t.formControl.pincode&&t.formControl.pincode.touched||null!=t.formControl&&null!=t.formControl.pincode&&t.formControl.pincode.dirty)?"green":""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==t.formControl||null==t.formControl.pincode?null:t.formControl.pincode.invalid)&&((null==t.formControl||null==t.formControl.pincode?null:t.formControl.pincode.touched)||(null==t.formControl||null==t.formControl.pincode?null:t.formControl.pincode.dirty))),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",t.products.length>0))},directives:[D.a,i.f,r.NgForOf,r.NgStyle,o.s,o.j,o.f,o.p,o.i,o.d,o.o,r.NgClass,o.l,o.r,r.NgIf,o.a,O.a,m.a],styles:[""]}),e})();var me=n("mrSG"),ue=n("cxbk");class pe{}const ge=["cardInfo"];function fe(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",34),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2,"Total Price(AUD)"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"h3"),l["\u0275\u0275text"](4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"]("$",e.total,"")}}function he(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",34),l["\u0275\u0275elementStart"](1,"h3"),l["\u0275\u0275text"](2,"Total Price(AUD)"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"h3"),l["\u0275\u0275text"](4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"]("$",e.total-e.dealerDiscountAmount,"")}}function ve(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p",35),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.cardNumberError," ")}}function Ce(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p",35),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.cardMonthError," ")}}function ye(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p",35),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.cardCvvError," ")}}function Se(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",36),l["\u0275\u0275text"](1," Name should be of minimum 5 characters "),l["\u0275\u0275elementEnd"]())}function Ie(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button"),l["\u0275\u0275elementStart"](1,"a",37),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.submitPaymentForm(t.paymentForm)})),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"]("Pay $",e.total,"")}}function Ee(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"button"),l["\u0275\u0275elementStart"](1,"a",20),l["\u0275\u0275element"](2,"span",38),l["\u0275\u0275text"](3,"Payment Processing "),l["\u0275\u0275element"](4,"i",39),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]())}const be=function(){return["/home"]},xe=function(){return["/cart"]};let we=(()=>{class e{constructor(e,t,n,r,o,l,a,i){this.fb=e,this.apiService=t,this.router=n,this.toastr=r,this.ngZone=o,this.activatedRoute=l,this.zone=a,this.spinner=i,this.paymentLoading=!1,this.cardErrors=new pe,this.cardHandler=this.onChange.bind(this),this.subscribe=[],this.total=0,this.toggleCanDeactivate=!0,this.countryList=[],this.products=[],this.toggleCardNumberError=!1,this.toggleCardMonthError=!1,this.toggleCardCvvError=!1,this.dealerDiscountAmount=0,this.applyDealerDiscount=!1}ngOnInit(){if(this.subscribe.push(this.activatedRoute.params.subscribe(e=>{e.id1&&(this.addressId=e.id1,this.buyNowCartId=e.id2,this.getAddress(e.id1))})),"Dealer"===window.atob(sessionStorage.getItem("userType"))&&"D"===window.atob(sessionStorage.getItem("userStatus")))if(this.applyDealerDiscount=!0,null===window.atob(sessionStorage.getItem("userDiscount")))this.apiService.dealerDiscount().subscribe(e=>{!0===e.return&&(this.dealerDiscountPercentage=e.data[0].discount_rate,this.dealerDiscountPercentage=.01*this.dealerDiscountPercentage)});else{let e=window.atob(sessionStorage.getItem("userDiscount"));this.dealerDiscountPercentage=.01*+e}this.subscribe.push(0===this.buyNowCartId.length?this.apiService.getCartById(window.atob(sessionStorage.getItem("cartId"))).subscribe(e=>{200===e.code&&(this.products=JSON.parse(e.details.cart),this.findGrandTotal())},e=>{var t;this.toastr.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message))}):this.apiService.getCartById(this.buyNowCartId).subscribe(e=>{200===e.code&&(this.products=JSON.parse(e.details.cart),this.findGrandTotal())},e=>{var t;this.toastr.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message))})),this.subscribe.push(this.apiService.getCountryData().subscribe(e=>{e&&(this.countryList=e.countries)})),this.createPaymentForm()}ngAfterViewInit(){this.spinner.show();const e={base:{iconColor:"#1586ad",color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"20px","::placeholder":{color:"rgba(190, 193, 197, 0.9)",fontSize:"0.9em",fontFamily:'"Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif'}},invalid:{color:"red",iconColor:"#fa755a"}};this.stripe=Stripe(ue.a.stripeTestKey);const t=this.stripe.elements();this.cardNumber=t.create("cardNumber",{showIcon:!0,placeholder:"Enter your card number",style:e}),this.cardNumber.mount("#cc-number"),this.cardNumber.on("change",e=>{(void 0===e.error||e)&&(void 0!==e.error?(this.toggleCardNumberError=!0,this.cardNumberError=e.error.message):this.toggleCardNumberError=!1)}),this.cardExpiry=t.create("cardExpiry",{placeholder:"MM / YY",style:e}),this.cardExpiry.mount("#cc-exp-date"),this.cardExpiry.on("change",e=>{(void 0===e.error||e)&&(void 0!==e.error?(this.toggleCardMonthError=!0,this.cardMonthError=e.error.message):this.toggleCardMonthError=!1)}),this.cardCvc=t.create("cardCvc",{placeholder:"Enter CVC",style:e}),this.cardCvc.mount("#cc-cvc"),this.cardCvc.on("change",e=>{(void 0===e.error||e)&&(void 0!==e.error?(this.toggleCardCvvError=!0,this.cardCvvError=e.error.message):this.toggleCardCvvError=!1)}),this.spinner.hide()}findGrandTotal(){let e,t,n=0,r=0,o=0;this.products.forEach(e=>{e.productQuantity&&(o=(e.discountPrice>0?e.discountPrice:e.price)*e.productQuantity+o)}),e=o,r=.05*e,n=e+r,t=.1*n,this.total=Math.round(t+n),this.dealerDiscountAmount=Math.round(this.dealerDiscountPercentage*this.total)}getAddress(e){this.subscribe.push(this.apiService.getAddressById(e).subscribe(e=>{e.address.length>0&&(this.addressDetails=e.address[0])}))}loadStripe(){if(!window.document.getElementById("stripe-custom-form-script")){const e=window.document.createElement("script");e.id="stripe-custom-form-script",e.type="text/javascript",e.src="https://js.stripe.com/v2/",e.onload=()=>{window.Stripe.setPublishableKey(ue.a.stripeTestKey)},window.document.body.appendChild(e)}}createPaymentForm(){this.paymentForm=this.fb.group({cardUserName:new o.c("",[o.q.minLength(5),o.q.required])})}get formControl(){return this.paymentForm.controls}validateAllFields(e){Object.keys(this.formControl).forEach(t=>{const n=e.get(t);n instanceof o.c?n.markAsTouched({onlySelf:!0}):n instanceof o.e&&this.validateAllFields(n)})}onChange({error:e}){this.cardErrors=e||null}submitPaymentForm(e){var t,n,r,o,l;return Object(me.a)(this,void 0,void 0,(function*(){if(e.invalid)this.validateAllFields(e);else{this.paymentLoading=!0,this.toggleCanDeactivate=!1;const{token:a,error:i}=yield this.stripe.createToken(this.cardNumber,{name:e.value.cardUserName,address_city:null===(t=this.addressDetails)||void 0===t?void 0:t.city,address_country:null===(n=this.addressDetails)||void 0===n?void 0:n.country,address_line1:null===(r=this.addressDetails)||void 0===r?void 0:r.house_no,address_state:null===(o=this.addressDetails)||void 0===o?void 0:o.state,address_zip:null===(l=this.addressDetails)||void 0===l?void 0:l.pincode});a?this.onSuccess(a):(this.spinner.hide("sp3"),this.onError(i))}}))}onSuccess(e){this.paymentLoading=!1;const t={token:e.id,amount:Math.round(this.total)};this.subscribe.push(this.apiService.payment(t).subscribe(e=>{200===e.code&&this.createOrder(t.token)},e=>{var t;this.paymentLoading=!1,this.toastr.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message))}))}onError(e){this.paymentLoading=!1,e.message&&this.toastr.error(e.message)}createOrder(e){const t=JSON.parse(window.atob(sessionStorage.getItem("additionalPaymentDetails"))),n=Object.assign({address_id:this.addressId,user_id:+window.atob(sessionStorage.getItem("id")),amount:this.total.toString(),transaction_id:e,purchase_details:this.products,cart_id:+window.atob(sessionStorage.getItem("cartId"))},t);this.subscribe.push(this.apiService.addOrders(n).subscribe(e=>{200===e.code&&(this.orderId=e.details.id,sessionStorage.removeItem("buyNow"),this.apiService.totalItemsInCart(),this.router.navigate(["/payment-successful"],{queryParams:{orderId:this.orderId}}))},e=>{var t;this.toastr.error((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message))}))}updateCart(){const e={id:window.atob(sessionStorage.getItem("cartId")),user_id:window.atob(sessionStorage.getItem("id")),cart:"[]"};console.log("update",e)}canDeactivate(){if(this.toggleCanDeactivate){if(sessionStorage.getItem("cartId")){if(sessionStorage.getItem("buyNow")){const e=JSON.parse(window.atob(sessionStorage.getItem("buyNow"))),t=[],n=[];let r;return null!==e&&e.forEach(e=>{"product"===e.type?r=new d.a(e.productId,e.code,e.description,e.price,e.discountPrice,e.type,e.pole,e.flow,e.head,e.speed,e.power,e.engineSpeed,e.enginekW,e.driveType,e.productQuantity):"accessory"===e.type?t.push(e):"spare"===e.type&&n.push(e)}),new Promise(e=>{this.subscribe.push(this.apiService.getCartById(window.atob(sessionStorage.getItem("cartId"))).subscribe(o=>{if(200===o.code){let l=[];if(l=JSON.parse(o.details.cart),l.length<=0)l.push(Object.assign({},r)),l.push(...t),l.push(...n);else{const e=new Array,o=new Array;let a={},i=!0,s=!0,d=!0;console.log(r,"cart"),console.log(l,"cart1");for(let c=0;c<l.length;c++)if("product"===l[c].type)d=!1,(""===l[c].driveType||l[c].driveType)===(""===r.driveType||r.driveType)&&l[c].code===r.code&&l[c].pole===r.pole?l[c].productQuantity++:a=r;else if("accessory"===l[c].type){s=!1;for(let n=0;n<t.length;n++)t[n].description===l[c].description&&t[n].pole===l[c].pole&&t[n].driveType===l[c].driveType?l[c].productQuantity++:l.some(e=>e.description===t[n].description&&e.pole===t[n].pole&&e.driveType===t[n].driveType)||e.some(e=>e.description===t[n].description&&e.pole===t[n].pole&&e.driveType===t[n].driveType)||e.push(t[n])}else if("spare"===l[c].type){i=!1;for(let e=0;e<n.length;e++)n[e].description===l[c].description&&n[e].pole===l[c].pole&&n[e].driveType===l[c].driveType?l[c].productQuantity++:l.some(t=>t.description===n[e].description&&t.pole===n[e].pole&&t.driveType===n[e].driveType)||o.some(t=>t.description===n[e].description&&t.pole===n[e].pole&&t.driveType===n[e].driveType)||o.push(n[e])}e.length>0&&l.push(...e),o.length>0&&l.push(...o),Object.keys(a).length>0&&l.push(Object.assign({},a)),s&&l.push(...t),i&&l.push(...n),d&&l.push(...r)}const a={id:window.atob(sessionStorage.getItem("cartId")),user_id:window.atob(sessionStorage.getItem("id")),cart:JSON.stringify(l)};return this.subscribe.push(this.apiService.updateCart(a).subscribe(t=>{if(200===t.code)return sessionStorage.removeItem("buyNow"),this.apiService.totalItemsInCart(),e(!0)}))}}))})}return!0}return sessionStorage.setItem("cartId",window.btoa(this.buyNowCartId)),this.apiService.totalItemsInCart(),sessionStorage.removeItem("buyNow"),!0}return!0}ngOnDestroy(){this.subscribe.forEach(e=>{e&&e.unsubscribe()}),this.cardNumber.destroy(),this.cardExpiry.destroy(),this.cardCvc.destroy()}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](o.b),l["\u0275\u0275directiveInject"](c.a),l["\u0275\u0275directiveInject"](i.c),l["\u0275\u0275directiveInject"](a.b),l["\u0275\u0275directiveInject"](l.NgZone),l["\u0275\u0275directiveInject"](i.a),l["\u0275\u0275directiveInject"](l.NgZone),l["\u0275\u0275directiveInject"](D.c))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-cart-payment"]],viewQuery:function(e,t){var n;1&e&&l["\u0275\u0275staticViewQuery"](ge,!0),2&e&&l["\u0275\u0275queryRefresh"](n=l["\u0275\u0275loadQuery"]())&&(t.cardElement=n.first)},decls:78,vars:18,consts:[["bdColor","rgb(0,0,0)","size","medium","color","#2e94ef","type","ball-newton-cradle",3,"fullScreen"],[2,"color","white"],[1,"main-container","cartpage","addresspage","paymentpage"],[1,"breadcrum"],[1,"container"],["href","javascript:void(0)",3,"routerLink"],[1,"cart-scale"],[1,"cart-scale-inner"],[1,"scale-no","active-scale"],[2,"pointer-events","none"],[1,"scale-no"],[1,"cart-section"],[1,"cart-inner"],[1,"price-detail"],[1,"price-row","total-price",2,"border-top","none"],["class","left-price-spare",4,"ngIf","ngIfElse"],["elsePart",""],[1,"left-price-spare","coupon-field"],["type","text","placeholder","Coupon Code"],[1,"coupon-btn"],["href","javascript:void(0)"],[1,"cart"],[1,"address-row","full-address-row"],[3,"formGroup"],[1,"address-feild"],["id","cc-number",3,"ngClass"],["style","color: red !important",4,"ngIf"],[1,"address-feild","half-field"],[2,"width","50%"],["id","cc-exp-date",3,"ngClass"],["id","cc-cvc",3,"ngClass"],["type","text","formControlName","cardUserName","placeholder","Navodita Aggarwal","required","",3,"ngClass"],["style","color: red",4,"ngIf"],[4,"ngIf"],[1,"left-price-spare"],[2,"color","red !important"],[2,"color","red"],["href","javascript:void(0)",3,"click"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"fas","fa-spinner","fa-spin"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ngx-spinner",0),l["\u0275\u0275elementStart"](1,"p",1),l["\u0275\u0275text"](2,"Loading..."),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"div",2),l["\u0275\u0275elementStart"](4,"div",3),l["\u0275\u0275elementStart"](5,"div",4),l["\u0275\u0275elementStart"](6,"p"),l["\u0275\u0275elementStart"](7,"a",5),l["\u0275\u0275text"](8,"Home"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](9," / "),l["\u0275\u0275elementStart"](10,"a",5),l["\u0275\u0275text"](11,"Cart"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](12," / Payment "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",6),l["\u0275\u0275elementStart"](14,"div",4),l["\u0275\u0275elementStart"](15,"div",7),l["\u0275\u0275elementStart"](16,"div",8),l["\u0275\u0275elementStart"](17,"a",9),l["\u0275\u0275text"](18,"1"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](19,"small"),l["\u0275\u0275text"](20,"Cart"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](21,"div",10),l["\u0275\u0275elementStart"](22,"a",9),l["\u0275\u0275text"](23,"2"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](24,"small"),l["\u0275\u0275text"](25,"Address"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](26,"div",10),l["\u0275\u0275elementStart"](27,"a",9),l["\u0275\u0275text"](28,"3"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](29,"small"),l["\u0275\u0275text"](30,"Payment"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](31,"div",11),l["\u0275\u0275elementStart"](32,"div",4),l["\u0275\u0275elementStart"](33,"div",12),l["\u0275\u0275elementStart"](34,"div",13),l["\u0275\u0275elementStart"](35,"div",14),l["\u0275\u0275template"](36,fe,5,1,"div",15),l["\u0275\u0275template"](37,he,5,1,"ng-template",null,16,l["\u0275\u0275templateRefExtractor"]),l["\u0275\u0275elementStart"](39,"div",17),l["\u0275\u0275element"](40,"input",18),l["\u0275\u0275elementStart"](41,"button",19),l["\u0275\u0275elementStart"](42,"a",20),l["\u0275\u0275text"](43,"Apply Coupon"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](44,"div",21),l["\u0275\u0275elementStart"](45,"div",22),l["\u0275\u0275elementStart"](46,"form",23),l["\u0275\u0275elementStart"](47,"div",24),l["\u0275\u0275elementStart"](48,"label"),l["\u0275\u0275text"](49,"Card Information "),l["\u0275\u0275elementStart"](50,"span"),l["\u0275\u0275text"](51,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](52,"div",25),l["\u0275\u0275template"](53,ve,2,1,"p",26),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](54,"div",27),l["\u0275\u0275elementStart"](55,"div",28),l["\u0275\u0275elementStart"](56,"label"),l["\u0275\u0275text"](57,"Exp. Month & Year "),l["\u0275\u0275elementStart"](58,"span"),l["\u0275\u0275text"](59,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](60,"div",29),l["\u0275\u0275template"](61,Ce,2,1,"p",26),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](62,"div",28),l["\u0275\u0275elementStart"](63,"label"),l["\u0275\u0275text"](64," CVV "),l["\u0275\u0275elementStart"](65,"span"),l["\u0275\u0275text"](66,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](67,"div",30),l["\u0275\u0275template"](68,ye,2,1,"p",26),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](69,"div",24),l["\u0275\u0275elementStart"](70,"label"),l["\u0275\u0275text"](71,"Name on Card "),l["\u0275\u0275elementStart"](72,"span"),l["\u0275\u0275text"](73,"*"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](74,"input",31),l["\u0275\u0275template"](75,Se,2,0,"p",32),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](76,Ie,3,1,"button",33),l["\u0275\u0275template"](77,Ee,5,0,"button",33),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](38);l["\u0275\u0275property"]("fullScreen",!0),l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](16,be)),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](17,xe)),l["\u0275\u0275advance"](26),l["\u0275\u0275property"]("ngIf",!t.applyDealerDiscount)("ngIfElse",e),l["\u0275\u0275advance"](10),l["\u0275\u0275property"]("formGroup",t.paymentForm),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",t.toggleCardNumberError?"cardErr":"address-feildCard"),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.toggleCardNumberError),l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("ngClass",t.toggleCardMonthError?"cardErr":"address-feildCard"),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.toggleCardMonthError),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",t.toggleCardCvvError?"cardErr":"address-feildCard"),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.toggleCardCvvError),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngClass",(null!=t.formControl&&null!=t.formControl.cardUserName&&null!=t.formControl.cardUserName.errors&&t.formControl.cardUserName.errors.minlength||null!=t.formControl&&null!=t.formControl.cardUserName&&null!=t.formControl.cardUserName.errors&&t.formControl.cardUserName.errors.required)&&(null!=t.formControl&&null!=t.formControl.cardUserName&&t.formControl.cardUserName.touched||null!=t.formControl&&null!=t.formControl.cardUserName&&t.formControl.cardUserName.dirty)?"red":null!=t.formControl&&null!=t.formControl.cardUserName&&t.formControl.cardUserName.valid&&(null!=t.formControl&&null!=t.formControl.cardUserName&&t.formControl.cardUserName.touched||null!=t.formControl&&null!=t.formControl.cardUserName&&t.formControl.cardUserName.dirty)?"green":""),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",((null==t.formControl||null==t.formControl.cardUserName||null==t.formControl.cardUserName.errors?null:t.formControl.cardUserName.errors.minlength)||(null==t.formControl||null==t.formControl.cardUserName||null==t.formControl.cardUserName.errors?null:t.formControl.cardUserName.errors.required))&&((null==t.formControl||null==t.formControl.cardUserName?null:t.formControl.cardUserName.touched)||(null==t.formControl||null==t.formControl.cardUserName?null:t.formControl.cardUserName.dirty))),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!t.paymentLoading),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.paymentLoading)}},directives:[D.a,i.f,r.NgIf,o.s,o.j,o.f,r.NgClass,o.a,o.i,o.d,o.o],styles:["#card-info[_ngcontent-%COMP%]{width:100%;font-size:14px;font-weight:400;height:48px;padding:10px;border:none;border-radius:2px;background:rgba(0,0,0,.05);-moz-appearance:none;appearance:none;-webkit-appearance:none}.cardErr[_ngcontent-%COMP%]{border:1px solid red!important}"]}),e})();var Ne=n("lJxs");let Pe=(()=>{class e{constructor(e){this.apiService=e}resolve(e,t){if(sessionStorage.getItem("cartId"))return this.apiService.getCartById(window.atob(sessionStorage.getItem("cartId"))).pipe(Object(Ne.a)(e=>200==+e.code?JSON.parse(e.details.cart):[]))}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](c.a))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Te=(()=>{class e{canDeactivate(e,t,n,r){return e.canDeactivate()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Ae=[{path:"",component:_,resolve:{cartData:Pe}},{path:"deliveryAddress",component:ce,canActivate:[s],canDeactivate:[Te]},{path:"payment/:id1/:id2",component:we,canActivate:[s],canDeactivate:[Te]}];let _e=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.g.forChild(Ae)],i.g]}),e})();var De=n("FUS3");n("2Vo4");let Oe=(()=>{let e=class{};return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)}}),e})(),ke=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[s,Te],imports:[[r.CommonModule,o.g,o.n,_e,De.a,Oe,a.a,D.b]]}),e})()}}]);